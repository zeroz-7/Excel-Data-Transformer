2025-10-06 00:43:49,655 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 00:43:49,656 - python_multipart.multipart - DEBUG - Calling on_header_field with data[36:55]
2025-10-06 00:43:49,657 - python_multipart.multipart - DEBUG - Calling on_header_value with data[57:81]
2025-10-06 00:43:49,658 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 00:43:49,658 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 00:43:49,659 - python_multipart.multipart - DEBUG - Calling on_part_data with data[85:563]
2025-10-06 00:43:49,659 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 00:43:49,660 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 00:43:49,662 - python_multipart.multipart - DEBUG - Calling on_header_field with data[601:620]
2025-10-06 00:43:49,664 - python_multipart.multipart - DEBUG - Calling on_header_value with data[622:665]
2025-10-06 00:43:49,665 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 00:43:49,666 - python_multipart.multipart - DEBUG - Calling on_header_field with data[667:679]
2025-10-06 00:43:49,669 - python_multipart.multipart - DEBUG - Calling on_header_value with data[681:746]
2025-10-06 00:43:49,670 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 00:43:49,671 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 00:43:49,672 - python_multipart.multipart - DEBUG - Calling on_part_data with data[750:6210]
2025-10-06 00:43:49,672 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 00:43:49,673 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 00:43:49,674 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6248:6267]
2025-10-06 00:43:49,675 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6269:6312]
2025-10-06 00:43:49,678 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 00:43:49,679 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6314:6326]
2025-10-06 00:43:49,680 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6328:6393]
2025-10-06 00:43:49,681 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 00:43:49,682 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 00:43:49,682 - python_multipart.multipart - DEBUG - Calling on_part_data with data[6397:11862]
2025-10-06 00:43:49,683 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 00:43:49,685 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 00:43:49,687 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11900:11919]
2025-10-06 00:43:49,687 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11921:11964]
2025-10-06 00:43:49,688 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 00:43:49,689 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11966:11978]
2025-10-06 00:43:49,690 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11980:12045]
2025-10-06 00:43:49,690 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 00:43:49,693 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 00:43:49,694 - python_multipart.multipart - DEBUG - Calling on_part_data with data[12049:17500]
2025-10-06 00:43:49,695 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 00:43:49,696 - python_multipart.multipart - DEBUG - Calling on_end with no data
2025-10-06 00:43:49,698 - backend.main - INFO - Processing 3 Excel files with prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_
2025-10-06 00:43:49,701 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpjr468w2o.xlsx (original: t3.xlsx)
2025-10-06 00:43:49,702 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpbzzgfbfp.xlsx (original: t2.xlsx)
2025-10-06 00:43:49,704 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpzrx9dhrz.xlsx (original: t1.xlsx)
2025-10-06 00:43:49,705 - backend.main - INFO - Starting crew execution...
2025-10-06 00:43:49,706 - backend.crewai_app.crewmain - INFO - Launching CsvOrganiser crew with inputs:
2025-10-06 00:43:49,708 - backend.crewai_app.crewmain - INFO - prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_5QI1_from_UE', 'DL_Volume_5QI2_towards_UE', and 'UL_Volume_5QI2_from_UE' columns...
2025-10-06 00:43:49,710 - backend.crewai_app.crewmain - INFO - files (list): ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpjr468w2o.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpbzzgfbfp.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpzrx9dhrz.xlsx']
2025-10-06 00:43:49,711 - backend.crewai_app.crewmain - INFO - files_str (preview): C:\Users\Anush\AppData\Local\Temp\tmpjr468w2o.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpbzzgfbfp.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpzrx9dhrz.xlsx
2025-10-06 00:43:49,759 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-06 00:43:49,760 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': '${GEMINI_API_KEY}'}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. The output must be modular, robust, well-commented, and include error handling and input validation.\n', 'output_format': 'python_code_only', 'instructions': ['Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. Your output should highlight missing logic, potential errors, and suggest improvements while ensuring all necessary transformations are applied.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-06 00:43:49,762 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': "You have been given a list of Excel file paths: {files_str} Your primary goal is to generate a structured, modular Python script to transform the data in these files based on the user's instructions: {prompt}. First, use the 'Excel Data Inspector Tool' with the provided file paths to understand the data structure of all files. Then, write the Python script. Ensure it includes step-by-step comments, error handling, and validation checks.\n", 'expected_output': 'A complete, executable Python script — no markdown, just valid Python code.\n'}, 'validation_task': {'description': "Review the Python script generated in the previous step against: 1. The user's original instructions: {prompt} 2. The actual structure of the provided Excel files: {files_str} Ensure that: - All requested transformations are correctly implemented. - The script handles every provided file and accounts for differing column structures. - The script includes error handling, validation, and safe data processing practices. If the script is perfect, output it directly. If there are issues, correct the script and provide the complete, final version.\n", 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.\n'}}
2025-10-06 00:43:49,763 - root - WARNING - Agent config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\agents.yaml. Proceeding with empty agent configurations.
2025-10-06 00:43:49,765 - root - WARNING - Task config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\tasks.yaml. Proceeding with empty task configurations.
2025-10-06 00:43:49,766 - backend.crewai_app.crew - INFO - Configured LLM: gemini/gemini-2.5-pro, api_key_set=yes
2025-10-06 00:43:49,777 - backend.crewai_app.crew - INFO - Configured LLM: gemini/gemini-2.5-pro, api_key_set=yes
2025-10-06 00:43:49,895 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 00:43:51,491 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): telemetry.crewai.com:4319
2025-10-06 00:43:53,740 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-06 00:44:03,997 - LiteLLM - INFO - Wrapper: Completed Call, calling success_handler
2025-10-06 00:44:04,053 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 00:44:09,013 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-06 00:44:27,937 - LiteLLM - INFO - Wrapper: Completed Call, calling success_handler
2025-10-06 00:44:28,033 - backend.main - INFO - Crew execution completed successfully
2025-10-06 00:44:28,033 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpjr468w2o.xlsx
2025-10-06 00:44:28,035 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpbzzgfbfp.xlsx
2025-10-06 00:44:28,037 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpzrx9dhrz.xlsx
2025-10-06 00:44:28,265 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (2): telemetry.crewai.com:4319
2025-10-06 00:44:29,989 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-06 00:44:29,991 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:02:02,522 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:05:32,296 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:06:07,203 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:06:16,063 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:06:46,378 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:06:55,168 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:14:20,045 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:18:00,558 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:21:03,260 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:22:26,092 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:22:26,095 - python_multipart.multipart - DEBUG - Calling on_header_field with data[36:55]
2025-10-06 01:22:26,096 - python_multipart.multipart - DEBUG - Calling on_header_value with data[57:81]
2025-10-06 01:22:26,096 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:22:26,097 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:22:26,097 - python_multipart.multipart - DEBUG - Calling on_part_data with data[85:563]
2025-10-06 01:22:26,098 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:22:26,099 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:22:26,100 - python_multipart.multipart - DEBUG - Calling on_header_field with data[601:620]
2025-10-06 01:22:26,100 - python_multipart.multipart - DEBUG - Calling on_header_value with data[622:665]
2025-10-06 01:22:26,101 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:22:26,101 - python_multipart.multipart - DEBUG - Calling on_header_field with data[667:679]
2025-10-06 01:22:26,102 - python_multipart.multipart - DEBUG - Calling on_header_value with data[681:746]
2025-10-06 01:22:26,103 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:22:26,104 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:22:26,107 - python_multipart.multipart - DEBUG - Calling on_part_data with data[750:6210]
2025-10-06 01:22:26,108 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:22:26,110 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:22:26,113 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6248:6267]
2025-10-06 01:22:26,114 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6269:6312]
2025-10-06 01:22:26,115 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:22:26,116 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6314:6326]
2025-10-06 01:22:26,116 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6328:6393]
2025-10-06 01:22:26,117 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:22:26,117 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:22:26,118 - python_multipart.multipart - DEBUG - Calling on_part_data with data[6397:11862]
2025-10-06 01:22:26,119 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:22:26,120 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:22:26,121 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11900:11919]
2025-10-06 01:22:26,122 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11921:11964]
2025-10-06 01:22:26,123 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:22:26,123 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11966:11978]
2025-10-06 01:22:26,123 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11980:12045]
2025-10-06 01:22:26,124 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:22:26,124 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:22:26,125 - python_multipart.multipart - DEBUG - Calling on_part_data with data[12049:17500]
2025-10-06 01:22:26,125 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:22:26,125 - python_multipart.multipart - DEBUG - Calling on_end with no data
2025-10-06 01:22:26,126 - backend.main - INFO - Processing 3 Excel files with prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_
2025-10-06 01:22:26,128 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpu6gv5_b_.xlsx (original: t3.xlsx)
2025-10-06 01:22:26,129 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpp52or0cd.xlsx (original: t2.xlsx)
2025-10-06 01:22:26,130 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpdea1_i_h.xlsx (original: t1.xlsx)
2025-10-06 01:22:26,131 - backend.main - INFO - Starting crew execution...
2025-10-06 01:22:26,131 - backend.crewai_app.crewmain - INFO - Launching CsvOrganiser crew with inputs:
2025-10-06 01:22:26,131 - backend.crewai_app.crewmain - INFO - prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_5QI1_from_UE', 'DL_Volume_5QI2_towards_UE', and 'UL_Volume_5QI2_from_UE' columns...
2025-10-06 01:22:26,132 - backend.crewai_app.crewmain - INFO - files (list): ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpu6gv5_b_.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpp52or0cd.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpdea1_i_h.xlsx']
2025-10-06 01:22:26,133 - backend.crewai_app.crewmain - INFO - files_str (preview): C:\Users\Anush\AppData\Local\Temp\tmpu6gv5_b_.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpp52or0cd.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpdea1_i_h.xlsx
2025-10-06 01:22:26,192 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-06 01:22:26,193 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': '${GEMINI_API_KEY}'}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. You excel at parsing JSON inspection results from Excel files and creating precise data processing scripts.\n', 'output_format': 'python_code_only', 'instructions': ['First, use the Excel Data Inspector Tool to get JSON structure of all Excel files.', 'Parse the JSON response to understand column names, data types, and sample data.', 'Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments referencing the JSON inspection results.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.', 'Handle multiple Excel files by merging them when appropriate.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. You verify that the script correctly uses column names and data types from the JSON inspection.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Verify column names match those in the JSON inspection results.', 'Ensure data type conversions are appropriate for the actual data.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-06 01:22:26,194 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': "CRITICAL: You MUST use the 'Excel Data Inspector Tool' FIRST to examine the actual Excel files before writing any code.\nExcel File Paths Provided: {files_str}\nUser Instructions: {prompt}\nStep 1: Use the Excel Data Inspector Tool with the exact file paths provided to understand the data structure. The tool returns JSON with:\n  - File metadata (rows, columns)\n  - Column names and data types\n  - Sample data preview\n\nStep 2: Parse the JSON response to understand the actual Excel file structures.\nStep 3: Based on the JSON inspection results and user instructions, generate a complete Python script. Step 4: The script must handle all transformations mentioned in: {prompt}\nImportant: The script should include proper error handling, data validation, and comments explaining each transformation step.\nExample transformations from requirements: - Merge and combine all Excel files - Convert columns to numeric where appropriate - Handle specific value replacements (-8888, NA values, etc.) - Create calculated columns (sums, differences) - Extract values from text columns - Split and concatenate columns - Map values from reference files\n", 'expected_output': 'A complete, executable Python script — no markdown, just valid Python code.\n'}, 'validation_task': {'description': 'CRITICAL: Review the generated Python script against: 1. The actual file structure from JSON inspection of: {files_str} 2. User instructions: {prompt}\nVerify that: - The script correctly handles the column names and data types found in the JSON inspection - All requested transformations from the prompt are implemented - The script properly handles multiple files if provided - Proper error handling and data validation are included - The code is efficient and well-commented\nPay special attention to: - Column name matching (exact names from JSON inspection) - Data type conversions - File merging logic for multiple files - Reference file mappings if required\nIf corrections are needed, provide the complete corrected script.\n', 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.'}}
2025-10-06 01:22:26,195 - root - WARNING - Agent config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\agents.yaml. Proceeding with empty agent configurations.
2025-10-06 01:22:26,196 - root - WARNING - Task config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\tasks.yaml. Proceeding with empty task configurations.
2025-10-06 01:22:26,197 - backend.crewai_app.crew - INFO - 📝 Creating script_generation_task with JSON inspection requirement
2025-10-06 01:22:26,197 - backend.crewai_app.crew - INFO - 🔧 Creating script_generator agent with enhanced JSON inspection
2025-10-06 01:22:26,198 - backend.crewai_app.crew - INFO - Configured LLM: gemini/gemini-2.5-pro, api_key_set=yes
2025-10-06 01:22:26,203 - backend.crewai_app.crew - INFO - 📝 Creating validation_task with JSON-aware validation
2025-10-06 01:22:26,203 - backend.crewai_app.crew - INFO - 🔧 Creating validator agent with JSON-aware validation
2025-10-06 01:22:26,204 - backend.crewai_app.crew - INFO - Configured LLM: gemini/gemini-2.5-pro, api_key_set=yes
2025-10-06 01:22:26,292 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 01:22:27,637 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 01:22:27,795 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 01:22:28,410 - backend.crewai_app.crewmain - ERROR - Error running crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=AIzaSyDtGnS_gvwvXJd4BA3XYN7NoeM4b7QyDJcg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 58, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-06 01:22:28,415 - backend.main - ERROR - Error during transformation: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}

2025-10-06 01:22:28,443 - backend.main - ERROR - Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=AIzaSyDtGnS_gvwvXJd4BA3XYN7NoeM4b7QyDJcg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 58, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\main.py", line 83, in transform
    result = run(prompt, saved_files)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 67, in run
    raise Exception(f"An error occurred while running the crew: {str(e)}")
Exception: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-06 01:22:28,448 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpu6gv5_b_.xlsx
2025-10-06 01:22:28,450 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpp52or0cd.xlsx
2025-10-06 01:22:28,451 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpdea1_i_h.xlsx
2025-10-06 01:22:30,259 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): telemetry.crewai.com:4319
2025-10-06 01:22:31,359 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-06 01:25:31,475 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:26:02,124 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:27:15,132 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:27:23,870 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:27:32,469 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:27:32,470 - python_multipart.multipart - DEBUG - Calling on_header_field with data[36:55]
2025-10-06 01:27:32,470 - python_multipart.multipart - DEBUG - Calling on_header_value with data[57:81]
2025-10-06 01:27:32,471 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:27:32,471 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:27:32,471 - python_multipart.multipart - DEBUG - Calling on_part_data with data[85:563]
2025-10-06 01:27:32,471 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:27:32,471 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:27:32,472 - python_multipart.multipart - DEBUG - Calling on_header_field with data[601:620]
2025-10-06 01:27:32,472 - python_multipart.multipart - DEBUG - Calling on_header_value with data[622:665]
2025-10-06 01:27:32,472 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:27:32,472 - python_multipart.multipart - DEBUG - Calling on_header_field with data[667:679]
2025-10-06 01:27:32,472 - python_multipart.multipart - DEBUG - Calling on_header_value with data[681:746]
2025-10-06 01:27:32,473 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:27:32,473 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:27:32,473 - python_multipart.multipart - DEBUG - Calling on_part_data with data[750:6210]
2025-10-06 01:27:32,473 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:27:32,474 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:27:32,474 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6248:6267]
2025-10-06 01:27:32,474 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6269:6312]
2025-10-06 01:27:32,474 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:27:32,475 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6314:6326]
2025-10-06 01:27:32,475 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6328:6393]
2025-10-06 01:27:32,475 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:27:32,475 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:27:32,476 - python_multipart.multipart - DEBUG - Calling on_part_data with data[6397:11862]
2025-10-06 01:27:32,476 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:27:32,476 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:27:32,476 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11900:11919]
2025-10-06 01:27:32,476 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11921:11964]
2025-10-06 01:27:32,477 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:27:32,477 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11966:11978]
2025-10-06 01:27:32,477 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11980:12045]
2025-10-06 01:27:32,477 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:27:32,477 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:27:32,478 - python_multipart.multipart - DEBUG - Calling on_part_data with data[12049:17500]
2025-10-06 01:27:32,478 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:27:32,478 - python_multipart.multipart - DEBUG - Calling on_end with no data
2025-10-06 01:27:32,479 - backend.main - INFO - Processing 3 Excel files with prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_
2025-10-06 01:27:32,480 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmp7kyzmldc.xlsx (original: t3.xlsx)
2025-10-06 01:27:32,481 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpt2ot09lu.xlsx (original: t2.xlsx)
2025-10-06 01:27:32,482 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmp4bjbm0wn.xlsx (original: t1.xlsx)
2025-10-06 01:27:32,482 - backend.main - INFO - Starting crew execution...
2025-10-06 01:27:32,482 - backend.crewai_app.crewmain - INFO - Launching CsvOrganiser crew with inputs:
2025-10-06 01:27:32,483 - backend.crewai_app.crewmain - INFO - prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_5QI1_from_UE', 'DL_Volume_5QI2_towards_UE', and 'UL_Volume_5QI2_from_UE' columns...
2025-10-06 01:27:32,483 - backend.crewai_app.crewmain - INFO - files (list): ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmp7kyzmldc.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpt2ot09lu.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmp4bjbm0wn.xlsx']
2025-10-06 01:27:32,483 - backend.crewai_app.crewmain - INFO - files_str (preview): C:\Users\Anush\AppData\Local\Temp\tmp7kyzmldc.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpt2ot09lu.xlsx | C:\Users\Anush\AppData\Local\Temp\tmp4bjbm0wn.xlsx
2025-10-06 01:27:32,489 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-06 01:27:32,489 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': '${GEMINI_API_KEY}'}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. You excel at parsing JSON inspection results from Excel files and creating precise data processing scripts.\n', 'output_format': 'python_code_only', 'instructions': ['First, use the Excel Data Inspector Tool to get JSON structure of all Excel files.', 'Parse the JSON response to understand column names, data types, and sample data.', 'Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments referencing the JSON inspection results.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.', 'Handle multiple Excel files by merging them when appropriate.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. You verify that the script correctly uses column names and data types from the JSON inspection.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Verify column names match those in the JSON inspection results.', 'Ensure data type conversions are appropriate for the actual data.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-06 01:27:32,490 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': "CRITICAL: You MUST use the 'Excel Data Inspector Tool' FIRST to examine the actual Excel files before writing any code.\nExcel File Paths Provided: {files_str}\nUser Instructions: {prompt}\nStep 1: Use the Excel Data Inspector Tool with the exact file paths provided to understand the data structure. The tool returns JSON with:\n  - File metadata (rows, columns)\n  - Column names and data types\n  - Sample data preview\n\nStep 2: Parse the JSON response to understand the actual Excel file structures.\nStep 3: Based on the JSON inspection results and user instructions, generate a complete Python script. Step 4: The script must handle all transformations mentioned in: {prompt}\nImportant: The script should include proper error handling, data validation, and comments explaining each transformation step.\nExample transformations from requirements: - Merge and combine all Excel files - Convert columns to numeric where appropriate - Handle specific value replacements (-8888, NA values, etc.) - Create calculated columns (sums, differences) - Extract values from text columns - Split and concatenate columns - Map values from reference files\n", 'expected_output': 'A complete, executable Python script — no markdown, just valid Python code.\n'}, 'validation_task': {'description': 'CRITICAL: Review the generated Python script against: 1. The actual file structure from JSON inspection of: {files_str} 2. User instructions: {prompt}\nVerify that: - The script correctly handles the column names and data types found in the JSON inspection - All requested transformations from the prompt are implemented - The script properly handles multiple files if provided - Proper error handling and data validation are included - The code is efficient and well-commented\nPay special attention to: - Column name matching (exact names from JSON inspection) - Data type conversions - File merging logic for multiple files - Reference file mappings if required\nIf corrections are needed, provide the complete corrected script.\n', 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.'}}
2025-10-06 01:27:32,491 - root - WARNING - Agent config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\agents.yaml. Proceeding with empty agent configurations.
2025-10-06 01:27:32,491 - root - WARNING - Task config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\tasks.yaml. Proceeding with empty task configurations.
2025-10-06 01:27:32,492 - backend.crewai_app.crew - INFO - 📝 Creating script_generation_task with JSON inspection requirement
2025-10-06 01:27:32,492 - backend.crewai_app.crew - INFO - 🔧 Creating script_generator agent with enhanced JSON inspection
2025-10-06 01:27:32,493 - backend.crewai_app.crew - INFO - Configured LLM: gemini/gemini-2.5-pro, api_key_set=yes
2025-10-06 01:27:32,496 - backend.crewai_app.crew - INFO - 📝 Creating validation_task with JSON-aware validation
2025-10-06 01:27:32,497 - backend.crewai_app.crew - INFO - 🔧 Creating validator agent with JSON-aware validation
2025-10-06 01:27:32,498 - backend.crewai_app.crew - INFO - Configured LLM: gemini/gemini-2.5-pro, api_key_set=yes
2025-10-06 01:27:32,540 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 01:27:33,639 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 01:27:33,783 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 01:27:34,442 - backend.crewai_app.crewmain - ERROR - Error running crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=AIzaSyDtGnS_gvwvXJd4BA3XYN7NoeM4b7QyDJcg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 58, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-06 01:27:34,447 - backend.main - ERROR - Error during transformation: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}

2025-10-06 01:27:34,471 - backend.main - ERROR - Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=AIzaSyDtGnS_gvwvXJd4BA3XYN7NoeM4b7QyDJcg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 58, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\main.py", line 83, in transform
    result = run(prompt, saved_files)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 67, in run
    raise Exception(f"An error occurred while running the crew: {str(e)}")
Exception: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-06 01:27:34,477 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmp7kyzmldc.xlsx
2025-10-06 01:27:34,477 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpt2ot09lu.xlsx
2025-10-06 01:27:34,478 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmp4bjbm0wn.xlsx
2025-10-06 01:27:36,066 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): telemetry.crewai.com:4319
2025-10-06 01:27:37,880 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-06 01:36:10,528 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:36:41,149 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:36:41,150 - python_multipart.multipart - DEBUG - Calling on_header_field with data[36:55]
2025-10-06 01:36:41,150 - python_multipart.multipart - DEBUG - Calling on_header_value with data[57:81]
2025-10-06 01:36:41,151 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:36:41,151 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:36:41,152 - python_multipart.multipart - DEBUG - Calling on_part_data with data[85:563]
2025-10-06 01:36:41,153 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:36:41,154 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:36:41,154 - python_multipart.multipart - DEBUG - Calling on_header_field with data[601:620]
2025-10-06 01:36:41,154 - python_multipart.multipart - DEBUG - Calling on_header_value with data[622:665]
2025-10-06 01:36:41,155 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:36:41,155 - python_multipart.multipart - DEBUG - Calling on_header_field with data[667:679]
2025-10-06 01:36:41,156 - python_multipart.multipart - DEBUG - Calling on_header_value with data[681:746]
2025-10-06 01:36:41,157 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:36:41,157 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:36:41,158 - python_multipart.multipart - DEBUG - Calling on_part_data with data[750:6210]
2025-10-06 01:36:41,160 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:36:41,161 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:36:41,161 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6248:6267]
2025-10-06 01:36:41,162 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6269:6312]
2025-10-06 01:36:41,162 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:36:41,163 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6314:6326]
2025-10-06 01:36:41,163 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6328:6393]
2025-10-06 01:36:41,163 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:36:41,163 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:36:41,164 - python_multipart.multipart - DEBUG - Calling on_part_data with data[6397:11862]
2025-10-06 01:36:41,164 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:36:41,164 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:36:41,165 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11900:11919]
2025-10-06 01:36:41,165 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11921:11964]
2025-10-06 01:36:41,165 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:36:41,166 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11966:11978]
2025-10-06 01:36:41,166 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11980:12045]
2025-10-06 01:36:41,167 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:36:41,169 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:36:41,169 - python_multipart.multipart - DEBUG - Calling on_part_data with data[12049:17500]
2025-10-06 01:36:41,169 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:36:41,170 - python_multipart.multipart - DEBUG - Calling on_end with no data
2025-10-06 01:36:41,172 - backend.main - INFO - Processing 3 Excel files with prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_
2025-10-06 01:36:41,175 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpn6syx5ub.xlsx (original: t3.xlsx)
2025-10-06 01:36:41,176 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpyct3xh3r.xlsx (original: t2.xlsx)
2025-10-06 01:36:41,178 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpt4c8b_xm.xlsx (original: t1.xlsx)
2025-10-06 01:36:41,178 - backend.main - INFO - Starting crew execution...
2025-10-06 01:36:41,179 - backend.crewai_app.crewmain - INFO - 🔑 API Key before crew: LOADED
2025-10-06 01:36:41,180 - backend.crewai_app.crewmain - INFO - 🔑 API Key starts with: AIzaSyDtGn...
2025-10-06 01:36:41,180 - backend.crewai_app.crewmain - INFO - Launching CsvOrganiser crew with inputs:
2025-10-06 01:36:41,181 - backend.crewai_app.crewmain - INFO - prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_5QI1_from_UE', 'DL_Volume_5QI2_towards_UE', and 'UL_Volume_5QI2_from_UE' columns...
2025-10-06 01:36:41,182 - backend.crewai_app.crewmain - INFO - files (list): ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpn6syx5ub.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpyct3xh3r.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpt4c8b_xm.xlsx']
2025-10-06 01:36:41,182 - backend.crewai_app.crewmain - INFO - files_str (preview): C:\Users\Anush\AppData\Local\Temp\tmpn6syx5ub.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpyct3xh3r.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpt4c8b_xm.xlsx
2025-10-06 01:36:41,189 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-06 01:36:41,190 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': '${GEMINI_API_KEY}'}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. You excel at parsing JSON inspection results from Excel files and creating precise data processing scripts.\n', 'output_format': 'python_code_only', 'instructions': ['First, use the Excel Data Inspector Tool to get JSON structure of all Excel files.', 'Parse the JSON response to understand column names, data types, and sample data.', 'Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments referencing the JSON inspection results.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.', 'Handle multiple Excel files by merging them when appropriate.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. You verify that the script correctly uses column names and data types from the JSON inspection.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Verify column names match those in the JSON inspection results.', 'Ensure data type conversions are appropriate for the actual data.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-06 01:36:41,191 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': "CRITICAL: You MUST use the 'Excel Data Inspector Tool' FIRST to examine the actual Excel files before writing any code.\nExcel File Paths Provided: {files_str}\nUser Instructions: {prompt}\nStep 1: Use the Excel Data Inspector Tool with the exact file paths provided to understand the data structure. The tool returns JSON with:\n  - File metadata (rows, columns)\n  - Column names and data types\n  - Sample data preview\n\nStep 2: Parse the JSON response to understand the actual Excel file structures.\nStep 3: Based on the JSON inspection results and user instructions, generate a complete Python script. Step 4: The script must handle all transformations mentioned in: {prompt}\nImportant: The script should include proper error handling, data validation, and comments explaining each transformation step.\nExample transformations from requirements: - Merge and combine all Excel files - Convert columns to numeric where appropriate - Handle specific value replacements (-8888, NA values, etc.) - Create calculated columns (sums, differences) - Extract values from text columns - Split and concatenate columns - Map values from reference files\n", 'expected_output': 'A complete, executable Python script — no markdown, just valid Python code.\n'}, 'validation_task': {'description': 'CRITICAL: Review the generated Python script against: 1. The actual file structure from JSON inspection of: {files_str} 2. User instructions: {prompt}\nVerify that: - The script correctly handles the column names and data types found in the JSON inspection - All requested transformations from the prompt are implemented - The script properly handles multiple files if provided - Proper error handling and data validation are included - The code is efficient and well-commented\nPay special attention to: - Column name matching (exact names from JSON inspection) - Data type conversions - File merging logic for multiple files - Reference file mappings if required\nIf corrections are needed, provide the complete corrected script.\n', 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.'}}
2025-10-06 01:36:41,192 - root - WARNING - Agent config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\agents.yaml. Proceeding with empty agent configurations.
2025-10-06 01:36:41,193 - root - WARNING - Task config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\tasks.yaml. Proceeding with empty task configurations.
2025-10-06 01:36:41,193 - backend.crewai_app.crew - INFO - 📝 Creating script_generation_task with JSON inspection requirement
2025-10-06 01:36:41,194 - backend.crewai_app.crew - INFO - 🔧 Creating script_generator agent with enhanced JSON inspection
2025-10-06 01:36:41,197 - backend.crewai_app.crew - INFO - Configured LLM: gemini/gemini-2.5-pro, api_key_set=yes
2025-10-06 01:36:41,200 - backend.crewai_app.crew - INFO - 📝 Creating validation_task with JSON-aware validation
2025-10-06 01:36:41,200 - backend.crewai_app.crew - INFO - 🔧 Creating validator agent with JSON-aware validation
2025-10-06 01:36:41,203 - backend.crewai_app.crew - INFO - Configured LLM: gemini/gemini-2.5-pro, api_key_set=yes
2025-10-06 01:36:41,263 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 01:36:42,458 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 01:36:42,599 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 01:36:42,698 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): telemetry.crewai.com:4319
2025-10-06 01:36:43,108 - backend.crewai_app.crewmain - ERROR - Error running crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=AIzaSyDtGnS_gvwvXJd4BA3XYN7NoeM4b7QyDJcg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 68, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-06 01:36:43,113 - backend.main - ERROR - Error during transformation: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}

2025-10-06 01:36:43,138 - backend.main - ERROR - Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=AIzaSyDtGnS_gvwvXJd4BA3XYN7NoeM4b7QyDJcg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 68, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\main.py", line 83, in transform
    result = run(prompt, saved_files)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 77, in run
    raise Exception(f"An error occurred while running the crew: {str(e)}")
Exception: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-06 01:36:43,145 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpn6syx5ub.xlsx
2025-10-06 01:36:43,145 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpyct3xh3r.xlsx
2025-10-06 01:36:43,147 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpt4c8b_xm.xlsx
2025-10-06 01:36:44,258 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-06 01:36:49,683 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-06 01:47:14,983 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:48:06,535 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:50:18,319 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:50:18,320 - python_multipart.multipart - DEBUG - Calling on_header_field with data[36:55]
2025-10-06 01:50:18,321 - python_multipart.multipart - DEBUG - Calling on_header_value with data[57:81]
2025-10-06 01:50:18,322 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:50:18,322 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:50:18,323 - python_multipart.multipart - DEBUG - Calling on_part_data with data[85:563]
2025-10-06 01:50:18,323 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:50:18,324 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:50:18,324 - python_multipart.multipart - DEBUG - Calling on_header_field with data[601:620]
2025-10-06 01:50:18,324 - python_multipart.multipart - DEBUG - Calling on_header_value with data[622:665]
2025-10-06 01:50:18,325 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:50:18,325 - python_multipart.multipart - DEBUG - Calling on_header_field with data[667:679]
2025-10-06 01:50:18,325 - python_multipart.multipart - DEBUG - Calling on_header_value with data[681:746]
2025-10-06 01:50:18,326 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:50:18,328 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:50:18,328 - python_multipart.multipart - DEBUG - Calling on_part_data with data[750:6210]
2025-10-06 01:50:18,329 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:50:18,329 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:50:18,330 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6248:6267]
2025-10-06 01:50:18,330 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6269:6312]
2025-10-06 01:50:18,331 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:50:18,332 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6314:6326]
2025-10-06 01:50:18,333 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6328:6393]
2025-10-06 01:50:18,334 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:50:18,334 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:50:18,335 - python_multipart.multipart - DEBUG - Calling on_part_data with data[6397:11862]
2025-10-06 01:50:18,335 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:50:18,335 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:50:18,336 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11900:11919]
2025-10-06 01:50:18,336 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11921:11964]
2025-10-06 01:50:18,341 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:50:18,341 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11966:11978]
2025-10-06 01:50:18,342 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11980:12045]
2025-10-06 01:50:18,342 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:50:18,343 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:50:18,343 - python_multipart.multipart - DEBUG - Calling on_part_data with data[12049:17500]
2025-10-06 01:50:18,344 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:50:18,344 - python_multipart.multipart - DEBUG - Calling on_end with no data
2025-10-06 01:50:18,345 - backend.main - INFO - Processing 3 Excel files with prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_
2025-10-06 01:50:18,347 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpkoa09zax.xlsx (original: t3.xlsx)
2025-10-06 01:50:18,349 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmp4wragz7k.xlsx (original: t2.xlsx)
2025-10-06 01:50:18,350 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmps_fv8ed6.xlsx (original: t1.xlsx)
2025-10-06 01:50:18,351 - backend.main - INFO - Starting crew execution...
2025-10-06 01:50:18,352 - backend.crewai_app.crewmain - INFO - 🔑 API Key before crew: LOADED
2025-10-06 01:50:18,352 - backend.crewai_app.crewmain - INFO - 🔑 API Key starts with: AIzaSyDtGn...
2025-10-06 01:50:18,353 - backend.crewai_app.crewmain - INFO - Launching CsvOrganiser crew with inputs:
2025-10-06 01:50:18,353 - backend.crewai_app.crewmain - INFO - prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_5QI1_from_UE', 'DL_Volume_5QI2_towards_UE', and 'UL_Volume_5QI2_from_UE' columns...
2025-10-06 01:50:18,354 - backend.crewai_app.crewmain - INFO - files (list): ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpkoa09zax.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmp4wragz7k.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmps_fv8ed6.xlsx']
2025-10-06 01:50:18,355 - backend.crewai_app.crewmain - INFO - files_str (preview): C:\Users\Anush\AppData\Local\Temp\tmpkoa09zax.xlsx | C:\Users\Anush\AppData\Local\Temp\tmp4wragz7k.xlsx | C:\Users\Anush\AppData\Local\Temp\tmps_fv8ed6.xlsx
2025-10-06 01:50:18,390 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-06 01:50:18,391 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': '${GEMINI_API_KEY}'}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. You excel at parsing JSON inspection results from Excel files and creating precise data processing scripts.\n', 'output_format': 'python_code_only', 'instructions': ['First, use the Excel Data Inspector Tool to get JSON structure of all Excel files.', 'Parse the JSON response to understand column names, data types, and sample data.', 'Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments referencing the JSON inspection results.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.', 'Handle multiple Excel files by merging them when appropriate.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. You verify that the script correctly uses column names and data types from the JSON inspection.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Verify column names match those in the JSON inspection results.', 'Ensure data type conversions are appropriate for the actual data.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-06 01:50:18,392 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': "CRITICAL: You MUST use the 'Excel Data Inspector Tool' FIRST to examine the actual Excel files before writing any code.\nExcel File Paths Provided: {files_str}\nUser Instructions: {prompt}\nStep 1: Use the Excel Data Inspector Tool with the exact file paths provided to understand the data structure. The tool returns JSON with:\n  - File metadata (rows, columns)\n  - Column names and data types\n  - Sample data preview\n\nStep 2: Parse the JSON response to understand the actual Excel file structures.\nStep 3: Based on the JSON inspection results and user instructions, generate a complete Python script. Step 4: The script must handle all transformations mentioned in: {prompt}\nImportant: The script should include proper error handling, data validation, and comments explaining each transformation step.\nExample transformations from requirements: - Merge and combine all Excel files - Convert columns to numeric where appropriate - Handle specific value replacements (-8888, NA values, etc.) - Create calculated columns (sums, differences) - Extract values from text columns - Split and concatenate columns - Map values from reference files\n", 'expected_output': 'A complete, executable Python script — no markdown, just valid Python code.\n'}, 'validation_task': {'description': 'CRITICAL: Review the generated Python script against: 1. The actual file structure from JSON inspection of: {files_str} 2. User instructions: {prompt}\nVerify that: - The script correctly handles the column names and data types found in the JSON inspection - All requested transformations from the prompt are implemented - The script properly handles multiple files if provided - Proper error handling and data validation are included - The code is efficient and well-commented\nPay special attention to: - Column name matching (exact names from JSON inspection) - Data type conversions - File merging logic for multiple files - Reference file mappings if required\nIf corrections are needed, provide the complete corrected script.\n', 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.'}}
2025-10-06 01:50:18,393 - root - WARNING - Agent config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\agents.yaml. Proceeding with empty agent configurations.
2025-10-06 01:50:18,393 - root - WARNING - Task config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\tasks.yaml. Proceeding with empty task configurations.
2025-10-06 01:50:18,394 - backend.crewai_app.crew - INFO - 📝 Creating script_generation_task with JSON inspection requirement
2025-10-06 01:50:18,394 - backend.crewai_app.crew - INFO - 🔧 Creating script_generator agent with enhanced JSON inspection
2025-10-06 01:50:18,395 - backend.crewai_app.crew - INFO - Configured LLM: gemini/gemini-2.5-pro, api_key_set=yes
2025-10-06 01:50:18,398 - backend.crewai_app.crew - INFO - 📝 Creating validation_task with JSON-aware validation
2025-10-06 01:50:18,398 - backend.crewai_app.crew - INFO - 🔧 Creating validator agent with JSON-aware validation
2025-10-06 01:50:18,400 - backend.crewai_app.crew - INFO - Configured LLM: gemini/gemini-2.5-pro, api_key_set=yes
2025-10-06 01:50:18,475 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 01:50:19,642 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): telemetry.crewai.com:4319
2025-10-06 01:50:19,849 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 01:50:20,001 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 01:50:20,699 - backend.crewai_app.crewmain - ERROR - Error running crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=AIzaSyDtGnS_gvwvXJd4BA3XYN7NoeM4b7QyDJcg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 66, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-06 01:50:20,703 - backend.main - ERROR - Error during transformation: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}

2025-10-06 01:50:20,743 - backend.main - ERROR - Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=AIzaSyDtGnS_gvwvXJd4BA3XYN7NoeM4b7QyDJcg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 66, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\main.py", line 83, in transform
    result = run(prompt, saved_files)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 75, in run
    raise Exception(f"An error occurred while running the crew: {str(e)}")
Exception: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-06 01:50:20,747 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpkoa09zax.xlsx
2025-10-06 01:50:20,748 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmp4wragz7k.xlsx
2025-10-06 01:50:20,748 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmps_fv8ed6.xlsx
2025-10-06 01:50:22,025 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-06 01:50:27,453 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-06 01:50:50,716 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-06 01:51:34,155 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:51:34,156 - python_multipart.multipart - DEBUG - Calling on_header_field with data[36:55]
2025-10-06 01:51:34,157 - python_multipart.multipart - DEBUG - Calling on_header_value with data[57:81]
2025-10-06 01:51:34,157 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:51:34,157 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:51:34,158 - python_multipart.multipart - DEBUG - Calling on_part_data with data[85:563]
2025-10-06 01:51:34,158 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:51:34,159 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:51:34,159 - python_multipart.multipart - DEBUG - Calling on_header_field with data[601:620]
2025-10-06 01:51:34,159 - python_multipart.multipart - DEBUG - Calling on_header_value with data[622:665]
2025-10-06 01:51:34,160 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:51:34,160 - python_multipart.multipart - DEBUG - Calling on_header_field with data[667:679]
2025-10-06 01:51:34,160 - python_multipart.multipart - DEBUG - Calling on_header_value with data[681:746]
2025-10-06 01:51:34,161 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:51:34,161 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:51:34,161 - python_multipart.multipart - DEBUG - Calling on_part_data with data[750:6210]
2025-10-06 01:51:34,162 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:51:34,163 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:51:34,163 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6248:6267]
2025-10-06 01:51:34,164 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6269:6312]
2025-10-06 01:51:34,164 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:51:34,165 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6314:6326]
2025-10-06 01:51:34,166 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6328:6393]
2025-10-06 01:51:34,166 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:51:34,166 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:51:34,168 - python_multipart.multipart - DEBUG - Calling on_part_data with data[6397:11862]
2025-10-06 01:51:34,168 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:51:34,168 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-06 01:51:34,169 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11900:11919]
2025-10-06 01:51:34,169 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11921:11964]
2025-10-06 01:51:34,169 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:51:34,170 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11966:11978]
2025-10-06 01:51:34,170 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11980:12045]
2025-10-06 01:51:34,170 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-06 01:51:34,170 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-06 01:51:34,171 - python_multipart.multipart - DEBUG - Calling on_part_data with data[12049:17500]
2025-10-06 01:51:34,171 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-06 01:51:34,171 - python_multipart.multipart - DEBUG - Calling on_end with no data
2025-10-06 01:51:34,172 - backend.main - INFO - Processing 3 Excel files with prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_
2025-10-06 01:51:34,174 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpnqbl7s_z.xlsx (original: t3.xlsx)
2025-10-06 01:51:34,176 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpnj_a90vk.xlsx (original: t2.xlsx)
2025-10-06 01:51:34,178 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmp1u7pqefv.xlsx (original: t1.xlsx)
2025-10-06 01:51:34,179 - backend.main - INFO - Starting crew execution...
2025-10-06 01:51:34,179 - backend.crewai_app.crewmain - INFO - 🔑 API Key before crew: LOADED
2025-10-06 01:51:34,180 - backend.crewai_app.crewmain - INFO - 🔑 API Key starts with: AIzaSyDtGn...
2025-10-06 01:51:34,180 - backend.crewai_app.crewmain - INFO - Launching CsvOrganiser crew with inputs:
2025-10-06 01:51:34,181 - backend.crewai_app.crewmain - INFO - prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_5QI1_from_UE', 'DL_Volume_5QI2_towards_UE', and 'UL_Volume_5QI2_from_UE' columns...
2025-10-06 01:51:34,181 - backend.crewai_app.crewmain - INFO - files (list): ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpnqbl7s_z.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpnj_a90vk.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmp1u7pqefv.xlsx']
2025-10-06 01:51:34,181 - backend.crewai_app.crewmain - INFO - files_str (preview): C:\Users\Anush\AppData\Local\Temp\tmpnqbl7s_z.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpnj_a90vk.xlsx | C:\Users\Anush\AppData\Local\Temp\tmp1u7pqefv.xlsx
2025-10-06 01:51:34,191 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-06 01:51:34,192 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': '${GEMINI_API_KEY}'}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. You excel at parsing JSON inspection results from Excel files and creating precise data processing scripts.\n', 'output_format': 'python_code_only', 'instructions': ['First, use the Excel Data Inspector Tool to get JSON structure of all Excel files.', 'Parse the JSON response to understand column names, data types, and sample data.', 'Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments referencing the JSON inspection results.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.', 'Handle multiple Excel files by merging them when appropriate.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. You verify that the script correctly uses column names and data types from the JSON inspection.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Verify column names match those in the JSON inspection results.', 'Ensure data type conversions are appropriate for the actual data.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-06 01:51:34,193 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': "CRITICAL: You MUST use the 'Excel Data Inspector Tool' FIRST to examine the actual Excel files before writing any code.\nExcel File Paths Provided: {files_str}\nUser Instructions: {prompt}\nStep 1: Use the Excel Data Inspector Tool with the exact file paths provided to understand the data structure. The tool returns JSON with:\n  - File metadata (rows, columns)\n  - Column names and data types\n  - Sample data preview\n\nStep 2: Parse the JSON response to understand the actual Excel file structures.\nStep 3: Based on the JSON inspection results and user instructions, generate a complete Python script. Step 4: The script must handle all transformations mentioned in: {prompt}\nImportant: The script should include proper error handling, data validation, and comments explaining each transformation step.\nExample transformations from requirements: - Merge and combine all Excel files - Convert columns to numeric where appropriate - Handle specific value replacements (-8888, NA values, etc.) - Create calculated columns (sums, differences) - Extract values from text columns - Split and concatenate columns - Map values from reference files\n", 'expected_output': 'A complete, executable Python script — no markdown, just valid Python code.\n'}, 'validation_task': {'description': 'CRITICAL: Review the generated Python script against: 1. The actual file structure from JSON inspection of: {files_str} 2. User instructions: {prompt}\nVerify that: - The script correctly handles the column names and data types found in the JSON inspection - All requested transformations from the prompt are implemented - The script properly handles multiple files if provided - Proper error handling and data validation are included - The code is efficient and well-commented\nPay special attention to: - Column name matching (exact names from JSON inspection) - Data type conversions - File merging logic for multiple files - Reference file mappings if required\nIf corrections are needed, provide the complete corrected script.\n', 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.'}}
2025-10-06 01:51:34,193 - root - WARNING - Agent config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\agents.yaml. Proceeding with empty agent configurations.
2025-10-06 01:51:34,194 - root - WARNING - Task config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\tasks.yaml. Proceeding with empty task configurations.
2025-10-06 01:51:34,195 - backend.crewai_app.crew - INFO - 📝 Creating script_generation_task with JSON inspection requirement
2025-10-06 01:51:34,195 - backend.crewai_app.crew - INFO - 🔧 Creating script_generator agent with enhanced JSON inspection
2025-10-06 01:51:34,196 - backend.crewai_app.crew - INFO - Configured LLM: gemini/gemini-2.5-pro, api_key_set=yes
2025-10-06 01:51:34,199 - backend.crewai_app.crew - INFO - 📝 Creating validation_task with JSON-aware validation
2025-10-06 01:51:34,200 - backend.crewai_app.crew - INFO - 🔧 Creating validator agent with JSON-aware validation
2025-10-06 01:51:34,201 - backend.crewai_app.crew - INFO - Configured LLM: gemini/gemini-2.5-pro, api_key_set=yes
2025-10-06 01:51:34,256 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 01:51:35,382 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 01:51:35,543 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-06 01:51:36,051 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): telemetry.crewai.com:4319
2025-10-06 01:51:36,126 - backend.crewai_app.crewmain - ERROR - Error running crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=AIzaSyDtGnS_gvwvXJd4BA3XYN7NoeM4b7QyDJcg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 66, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-06 01:51:36,130 - backend.main - ERROR - Error during transformation: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}

2025-10-06 01:51:36,157 - backend.main - ERROR - Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=AIzaSyDtGnS_gvwvXJd4BA3XYN7NoeM4b7QyDJcg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 66, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\main.py", line 83, in transform
    result = run(prompt, saved_files)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 75, in run
    raise Exception(f"An error occurred while running the crew: {str(e)}")
Exception: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-06 01:51:36,161 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpnqbl7s_z.xlsx
2025-10-06 01:51:36,162 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpnj_a90vk.xlsx
2025-10-06 01:51:36,163 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmp1u7pqefv.xlsx
2025-10-06 01:51:37,221 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-06 01:51:42,616 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-06 02:25:11,312 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 01:07:19,650 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 01:07:19,652 - python_multipart.multipart - DEBUG - Calling on_header_field with data[36:55]
2025-10-07 01:07:19,652 - python_multipart.multipart - DEBUG - Calling on_header_value with data[57:81]
2025-10-07 01:07:19,653 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 01:07:19,654 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 01:07:19,654 - python_multipart.multipart - DEBUG - Calling on_part_data with data[85:563]
2025-10-07 01:07:19,656 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 01:07:19,656 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 01:07:19,659 - python_multipart.multipart - DEBUG - Calling on_header_field with data[601:620]
2025-10-07 01:07:19,660 - python_multipart.multipart - DEBUG - Calling on_header_value with data[622:665]
2025-10-07 01:07:19,661 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 01:07:19,661 - python_multipart.multipart - DEBUG - Calling on_header_field with data[667:679]
2025-10-07 01:07:19,662 - python_multipart.multipart - DEBUG - Calling on_header_value with data[681:746]
2025-10-07 01:07:19,662 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 01:07:19,663 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 01:07:19,664 - python_multipart.multipart - DEBUG - Calling on_part_data with data[750:6210]
2025-10-07 01:07:19,667 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 01:07:19,668 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 01:07:19,668 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6248:6267]
2025-10-07 01:07:19,669 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6269:6312]
2025-10-07 01:07:19,670 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 01:07:19,670 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6314:6326]
2025-10-07 01:07:19,674 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6328:6393]
2025-10-07 01:07:19,675 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 01:07:19,675 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 01:07:19,676 - python_multipart.multipart - DEBUG - Calling on_part_data with data[6397:11862]
2025-10-07 01:07:19,677 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 01:07:19,677 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 01:07:19,678 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11900:11919]
2025-10-07 01:07:19,679 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11921:11964]
2025-10-07 01:07:19,682 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 01:07:19,682 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11966:11978]
2025-10-07 01:07:19,683 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11980:12045]
2025-10-07 01:07:19,684 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 01:07:19,684 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 01:07:19,685 - python_multipart.multipart - DEBUG - Calling on_part_data with data[12049:17500]
2025-10-07 01:07:19,687 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 01:07:19,687 - python_multipart.multipart - DEBUG - Calling on_end with no data
2025-10-07 01:07:19,689 - backend.main - INFO - Processing 3 Excel files with prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_
2025-10-07 01:07:19,692 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmplo5fv0vq.xlsx (original: t3.xlsx)
2025-10-07 01:07:19,695 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpm85g7u31.xlsx (original: t2.xlsx)
2025-10-07 01:07:19,697 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmp6r7zltls.xlsx (original: t1.xlsx)
2025-10-07 01:07:19,697 - backend.main - INFO - Starting crew execution...
2025-10-07 01:07:19,698 - backend.crewai_app.crewmain - INFO - 🔑 API Key before crew: LOADED
2025-10-07 01:07:19,699 - backend.crewai_app.crewmain - INFO - 🔑 API Key starts with: AIzaSyDtGn...
2025-10-07 01:07:19,700 - backend.crewai_app.crewmain - INFO - Launching CsvOrganiser crew with inputs:
2025-10-07 01:07:19,702 - backend.crewai_app.crewmain - INFO - prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_5QI1_from_UE', 'DL_Volume_5QI2_towards_UE', and 'UL_Volume_5QI2_from_UE' columns...
2025-10-07 01:07:19,703 - backend.crewai_app.crewmain - INFO - files (list): ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmplo5fv0vq.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpm85g7u31.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmp6r7zltls.xlsx']
2025-10-07 01:07:19,705 - backend.crewai_app.crewmain - INFO - files_str (preview): C:\Users\Anush\AppData\Local\Temp\tmplo5fv0vq.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpm85g7u31.xlsx | C:\Users\Anush\AppData\Local\Temp\tmp6r7zltls.xlsx
2025-10-07 01:07:19,752 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-07 01:07:19,754 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': '${GEMINI_API_KEY}'}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. You excel at parsing JSON inspection results from Excel files and creating precise data processing scripts.\n', 'output_format': 'python_code_only', 'instructions': ['First, use the Excel Data Inspector Tool to get JSON structure of all Excel files.', 'Parse the JSON response to understand column names, data types, and sample data.', 'Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments referencing the JSON inspection results.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.', 'Handle multiple Excel files by merging them when appropriate.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. You verify that the script correctly uses column names and data types from the JSON inspection.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Verify column names match those in the JSON inspection results.', 'Ensure data type conversions are appropriate for the actual data.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-07 01:07:19,755 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': "CRITICAL: You MUST use the 'Excel Data Inspector Tool' FIRST to examine the actual Excel files before writing any code.\nExcel File Paths Provided: {files_str}\nUser Instructions: {prompt}\nStep 1: Use the Excel Data Inspector Tool with the exact file paths provided to understand the data structure. The tool returns JSON with:\n  - File metadata (rows, columns)\n  - Column names and data types\n  - Sample data preview\n\nStep 2: Parse the JSON response to understand the actual Excel file structures.\nStep 3: Based on the JSON inspection results and user instructions, generate a complete Python script. Step 4: The script must handle all transformations mentioned in: {prompt}\nImportant: The script should include proper error handling, data validation, and comments explaining each transformation step.\nExample transformations from requirements: - Merge and combine all Excel files - Convert columns to numeric where appropriate - Handle specific value replacements (-8888, NA values, etc.) - Create calculated columns (sums, differences) - Extract values from text columns - Split and concatenate columns - Map values from reference files\n", 'expected_output': 'A complete, executable Python script — no markdown, just valid Python code.\n'}, 'validation_task': {'description': 'CRITICAL: Review the generated Python script against: 1. The actual file structure from JSON inspection of: {files_str} 2. User instructions: {prompt}\nVerify that: - The script correctly handles the column names and data types found in the JSON inspection - All requested transformations from the prompt are implemented - The script properly handles multiple files if provided - Proper error handling and data validation are included - The code is efficient and well-commented\nPay special attention to: - Column name matching (exact names from JSON inspection) - Data type conversions - File merging logic for multiple files - Reference file mappings if required\nIf corrections are needed, provide the complete corrected script.\n', 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.'}}
2025-10-07 01:07:19,756 - root - WARNING - Agent config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\agents.yaml. Proceeding with empty agent configurations.
2025-10-07 01:07:19,764 - root - WARNING - Task config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\tasks.yaml. Proceeding with empty task configurations.
2025-10-07 01:07:19,769 - backend.crewai_app.crew - INFO - 📝 Creating script_generation_task with JSON inspection requirement
2025-10-07 01:07:19,769 - backend.crewai_app.crew - INFO - 🔧 Creating script_generator agent with enhanced JSON inspection
2025-10-07 01:07:19,770 - backend.crewai_app.crew - INFO - 🔑 API Key from env: SET
2025-10-07 01:07:19,771 - backend.crewai_app.crew - INFO - 🔑 API Key from config: NOT SET
2025-10-07 01:07:19,772 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 01:07:19,773 - backend.crewai_app.crew - INFO - Configured LLM: gemini/gemini-2.5-pro, api_key_set=yes
2025-10-07 01:07:19,797 - backend.crewai_app.crew - INFO - 📝 Creating validation_task with JSON-aware validation
2025-10-07 01:07:19,799 - backend.crewai_app.crew - INFO - 🔧 Creating validator agent with JSON-aware validation
2025-10-07 01:07:19,799 - backend.crewai_app.crew - INFO - 🔑 API Key from env: SET
2025-10-07 01:07:19,800 - backend.crewai_app.crew - INFO - 🔑 API Key from config: NOT SET
2025-10-07 01:07:19,801 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 01:07:19,801 - backend.crewai_app.crew - INFO - Configured LLM: gemini/gemini-2.5-pro, api_key_set=yes
2025-10-07 01:07:19,932 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-07 01:07:21,670 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-07 01:07:21,830 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-07 01:07:22,426 - backend.crewai_app.crewmain - ERROR - Error running crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=AIzaSyDtGnS_gvwvXJd4BA3XYN7NoeM4b7QyDJcg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 66, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-07 01:07:22,430 - backend.main - ERROR - Error during transformation: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}

2025-10-07 01:07:22,493 - backend.main - ERROR - Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=AIzaSyDtGnS_gvwvXJd4BA3XYN7NoeM4b7QyDJcg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 66, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\main.py", line 83, in transform
    result = run(prompt, saved_files)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 75, in run
    raise Exception(f"An error occurred while running the crew: {str(e)}")
Exception: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-07 01:07:22,502 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmplo5fv0vq.xlsx
2025-10-07 01:07:22,503 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpm85g7u31.xlsx
2025-10-07 01:07:22,505 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmp6r7zltls.xlsx
2025-10-07 01:07:23,965 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): telemetry.crewai.com:4319
2025-10-07 01:07:26,917 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 01:29:34,677 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 02:04:25,635 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 02:09:26,600 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 02:30:32,045 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 02:30:32,048 - python_multipart.multipart - DEBUG - Calling on_header_field with data[36:55]
2025-10-07 02:30:32,048 - python_multipart.multipart - DEBUG - Calling on_header_value with data[57:81]
2025-10-07 02:30:32,049 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 02:30:32,049 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 02:30:32,050 - python_multipart.multipart - DEBUG - Calling on_part_data with data[85:563]
2025-10-07 02:30:32,050 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 02:30:32,050 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 02:30:32,050 - python_multipart.multipart - DEBUG - Calling on_header_field with data[601:620]
2025-10-07 02:30:32,051 - python_multipart.multipart - DEBUG - Calling on_header_value with data[622:665]
2025-10-07 02:30:32,051 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 02:30:32,051 - python_multipart.multipart - DEBUG - Calling on_header_field with data[667:679]
2025-10-07 02:30:32,051 - python_multipart.multipart - DEBUG - Calling on_header_value with data[681:746]
2025-10-07 02:30:32,051 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 02:30:32,052 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 02:30:32,053 - python_multipart.multipart - DEBUG - Calling on_part_data with data[750:6210]
2025-10-07 02:30:32,053 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 02:30:32,053 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 02:30:32,054 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6248:6267]
2025-10-07 02:30:32,054 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6269:6312]
2025-10-07 02:30:32,054 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 02:30:32,054 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6314:6326]
2025-10-07 02:30:32,054 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6328:6393]
2025-10-07 02:30:32,055 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 02:30:32,055 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 02:30:32,055 - python_multipart.multipart - DEBUG - Calling on_part_data with data[6397:11862]
2025-10-07 02:30:32,057 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 02:30:32,057 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 02:30:32,057 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11900:11919]
2025-10-07 02:30:32,057 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11921:11964]
2025-10-07 02:30:32,057 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 02:30:32,058 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11966:11978]
2025-10-07 02:30:32,058 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11980:12045]
2025-10-07 02:30:32,058 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 02:30:32,059 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 02:30:32,059 - python_multipart.multipart - DEBUG - Calling on_part_data with data[12049:17500]
2025-10-07 02:30:32,059 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 02:30:32,060 - python_multipart.multipart - DEBUG - Calling on_end with no data
2025-10-07 02:30:32,061 - backend.main - INFO - Processing 3 Excel files with prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_
2025-10-07 02:30:32,062 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmp7038b7ci.xlsx (original: t3.xlsx)
2025-10-07 02:30:32,065 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpttiidtvl.xlsx (original: t2.xlsx)
2025-10-07 02:30:32,067 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpxvqw1p3h.xlsx (original: t1.xlsx)
2025-10-07 02:30:32,067 - backend.main - INFO - Starting crew execution...
2025-10-07 02:30:32,068 - backend.crewai_app.crewmain - INFO - 🔑 API Key before crew: LOADED
2025-10-07 02:30:32,068 - backend.crewai_app.crewmain - INFO - 🔑 API Key starts with: AIzaSyDtGn...
2025-10-07 02:30:32,069 - backend.crewai_app.crewmain - INFO - Launching CsvOrganiser crew with inputs:
2025-10-07 02:30:32,069 - backend.crewai_app.crewmain - INFO - prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_5QI1_from_UE', 'DL_Volume_5QI2_towards_UE', and 'UL_Volume_5QI2_from_UE' columns...
2025-10-07 02:30:32,069 - backend.crewai_app.crewmain - INFO - files (list): ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmp7038b7ci.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpttiidtvl.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpxvqw1p3h.xlsx']
2025-10-07 02:30:32,071 - backend.crewai_app.crewmain - INFO - files_str (preview): C:\Users\Anush\AppData\Local\Temp\tmp7038b7ci.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpttiidtvl.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpxvqw1p3h.xlsx
2025-10-07 02:30:32,080 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-07 02:30:32,080 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': '${GEMINI_API_KEY}'}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. You excel at parsing JSON inspection results from Excel files and creating precise data processing scripts.\n', 'output_format': 'python_code_only', 'instructions': ['First, use the Excel Data Inspector Tool to get JSON structure of all Excel files.', 'Parse the JSON response to understand column names, data types, and sample data.', 'Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments referencing the JSON inspection results.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.', 'Handle multiple Excel files by merging them when appropriate.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. You verify that the script correctly uses column names and data types from the JSON inspection.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Verify column names match those in the JSON inspection results.', 'Ensure data type conversions are appropriate for the actual data.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-07 02:30:32,081 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': "CRITICAL: You MUST use the 'Excel Data Inspector Tool' FIRST to examine the actual Excel files before writing any code.\nExcel File Paths Provided: {files_str}\nUser Instructions: {prompt}\nStep 1: Use the Excel Data Inspector Tool with the exact file paths provided to understand the data structure. The tool returns JSON with:\n  - File metadata (rows, columns)\n  - Column names and data types\n  - Sample data preview\n\nStep 2: Parse the JSON response to understand the actual Excel file structures.\nStep 3: Based on the JSON inspection results and user instructions, generate a complete Python script. Step 4: The script must handle all transformations mentioned in: {prompt}\nImportant: The script should include proper error handling, data validation, and comments explaining each transformation step.\nExample transformations from requirements: - Merge and combine all Excel files - Convert columns to numeric where appropriate - Handle specific value replacements (-8888, NA values, etc.) - Create calculated columns (sums, differences) - Extract values from text columns - Split and concatenate columns - Map values from reference files\n", 'expected_output': 'A complete, executable Python script — no markdown, just valid Python code.\n'}, 'validation_task': {'description': 'CRITICAL: Review the generated Python script against: 1. The actual file structure from JSON inspection of: {files_str} 2. User instructions: {prompt}\nVerify that: - The script correctly handles the column names and data types found in the JSON inspection - All requested transformations from the prompt are implemented - The script properly handles multiple files if provided - Proper error handling and data validation are included - The code is efficient and well-commented\nPay special attention to: - Column name matching (exact names from JSON inspection) - Data type conversions - File merging logic for multiple files - Reference file mappings if required\nIf corrections are needed, provide the complete corrected script.\n', 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.'}}
2025-10-07 02:30:32,082 - root - WARNING - Agent config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\agents.yaml. Proceeding with empty agent configurations.
2025-10-07 02:30:32,082 - root - WARNING - Task config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\tasks.yaml. Proceeding with empty task configurations.
2025-10-07 02:30:32,083 - backend.crewai_app.crew - INFO - 📝 Creating script_generation_task with JSON inspection requirement
2025-10-07 02:30:32,083 - backend.crewai_app.crew - INFO - 🔧 Creating script_generator agent with enhanced JSON inspection
2025-10-07 02:30:32,084 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 02:30:32,084 - backend.crewai_app.crew - INFO - 🔑 Config API Key: NOT SET
2025-10-07 02:30:32,084 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 02:30:32,087 - backend.crewai_app.crew - INFO - 📝 Creating validation_task with JSON-aware validation
2025-10-07 02:30:32,089 - backend.crewai_app.crew - INFO - 🔧 Creating validator agent with JSON-aware validation
2025-10-07 02:30:32,089 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 02:30:32,090 - backend.crewai_app.crew - INFO - 🔑 Config API Key: NOT SET
2025-10-07 02:30:32,090 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 02:30:32,136 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-07 02:30:33,220 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-07 02:30:33,365 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-07 02:30:33,867 - backend.crewai_app.crewmain - ERROR - Error running crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=AIzaSyDtGnS_gvwvXJd4BA3XYN7NoeM4b7QyDJcg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 68, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-07 02:30:33,872 - backend.main - ERROR - Error during transformation: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}

2025-10-07 02:30:33,895 - backend.main - ERROR - Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=AIzaSyDtGnS_gvwvXJd4BA3XYN7NoeM4b7QyDJcg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 68, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\main.py", line 86, in transform
    result = run(prompt, saved_files)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 77, in run
    raise Exception(f"An error occurred while running the crew: {str(e)}")
Exception: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-07 02:30:33,900 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmp7038b7ci.xlsx
2025-10-07 02:30:33,901 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpttiidtvl.xlsx
2025-10-07 02:30:33,902 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpxvqw1p3h.xlsx
2025-10-07 02:30:34,873 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): telemetry.crewai.com:4319
2025-10-07 02:30:36,468 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 02:37:01,901 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 02:43:47,302 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 02:43:47,303 - python_multipart.multipart - DEBUG - Calling on_header_field with data[36:55]
2025-10-07 02:43:47,303 - python_multipart.multipart - DEBUG - Calling on_header_value with data[57:81]
2025-10-07 02:43:47,304 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 02:43:47,304 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 02:43:47,306 - python_multipart.multipart - DEBUG - Calling on_part_data with data[85:563]
2025-10-07 02:43:47,306 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 02:43:47,306 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 02:43:47,307 - python_multipart.multipart - DEBUG - Calling on_header_field with data[601:620]
2025-10-07 02:43:47,307 - python_multipart.multipart - DEBUG - Calling on_header_value with data[622:665]
2025-10-07 02:43:47,307 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 02:43:47,308 - python_multipart.multipart - DEBUG - Calling on_header_field with data[667:679]
2025-10-07 02:43:47,308 - python_multipart.multipart - DEBUG - Calling on_header_value with data[681:746]
2025-10-07 02:43:47,308 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 02:43:47,309 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 02:43:47,309 - python_multipart.multipart - DEBUG - Calling on_part_data with data[750:6210]
2025-10-07 02:43:47,309 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 02:43:47,310 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 02:43:47,310 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6248:6267]
2025-10-07 02:43:47,311 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6269:6312]
2025-10-07 02:43:47,311 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 02:43:47,311 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6314:6326]
2025-10-07 02:43:47,312 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6328:6393]
2025-10-07 02:43:47,312 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 02:43:47,313 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 02:43:47,313 - python_multipart.multipart - DEBUG - Calling on_part_data with data[6397:11862]
2025-10-07 02:43:47,313 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 02:43:47,314 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 02:43:47,314 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11900:11919]
2025-10-07 02:43:47,314 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11921:11964]
2025-10-07 02:43:47,315 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 02:43:47,315 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11966:11978]
2025-10-07 02:43:47,315 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11980:12045]
2025-10-07 02:43:47,315 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 02:43:47,316 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 02:43:47,316 - python_multipart.multipart - DEBUG - Calling on_part_data with data[12049:17500]
2025-10-07 02:43:47,316 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 02:43:47,316 - python_multipart.multipart - DEBUG - Calling on_end with no data
2025-10-07 02:43:47,318 - backend.main - INFO - Processing 3 Excel files with prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_
2025-10-07 02:43:47,320 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmp6yu3hdo1.xlsx (original: t3.xlsx)
2025-10-07 02:43:47,321 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpz_hy2xbv.xlsx (original: t2.xlsx)
2025-10-07 02:43:47,322 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpivfj5ep_.xlsx (original: t1.xlsx)
2025-10-07 02:43:47,324 - backend.main - INFO - Starting crew execution...
2025-10-07 02:43:47,324 - backend.crewai_app.crewmain - INFO - 🔑 API Key before crew: LOADED
2025-10-07 02:43:47,325 - backend.crewai_app.crewmain - INFO - 🔑 API Key starts with: AIzaSyDtGn...
2025-10-07 02:43:47,325 - backend.crewai_app.crewmain - INFO - Launching CsvOrganiser crew with inputs:
2025-10-07 02:43:47,325 - backend.crewai_app.crewmain - INFO - prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_5QI1_from_UE', 'DL_Volume_5QI2_towards_UE', and 'UL_Volume_5QI2_from_UE' columns...
2025-10-07 02:43:47,326 - backend.crewai_app.crewmain - INFO - files (list): ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmp6yu3hdo1.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpz_hy2xbv.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpivfj5ep_.xlsx']
2025-10-07 02:43:47,327 - backend.crewai_app.crewmain - INFO - files_str (preview): C:\Users\Anush\AppData\Local\Temp\tmp6yu3hdo1.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpz_hy2xbv.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpivfj5ep_.xlsx
2025-10-07 02:43:47,367 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-07 02:43:47,367 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': '${GEMINI_API_KEY}'}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. You excel at parsing JSON inspection results from Excel files and creating precise data processing scripts.\n', 'output_format': 'python_code_only', 'instructions': ['First, use the Excel Data Inspector Tool to get JSON structure of all Excel files.', 'Parse the JSON response to understand column names, data types, and sample data.', 'Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments referencing the JSON inspection results.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.', 'Handle multiple Excel files by merging them when appropriate.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. You verify that the script correctly uses column names and data types from the JSON inspection.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Verify column names match those in the JSON inspection results.', 'Ensure data type conversions are appropriate for the actual data.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-07 02:43:47,368 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': "CRITICAL: You MUST use the 'Excel Data Inspector Tool' FIRST to examine the actual Excel files before writing any code.\nExcel File Paths Provided: {files_str}\nUser Instructions: {prompt}\nStep 1: Use the Excel Data Inspector Tool with the exact file paths provided to understand the data structure. The tool returns JSON with:\n  - File metadata (rows, columns)\n  - Column names and data types\n  - Sample data preview\n\nStep 2: Parse the JSON response to understand the actual Excel file structures.\nStep 3: Based on the JSON inspection results and user instructions, generate a complete Python script. Step 4: The script must handle all transformations mentioned in: {prompt}\nImportant: The script should include proper error handling, data validation, and comments explaining each transformation step.\nExample transformations from requirements: - Merge and combine all Excel files - Convert columns to numeric where appropriate - Handle specific value replacements (-8888, NA values, etc.) - Create calculated columns (sums, differences) - Extract values from text columns - Split and concatenate columns - Map values from reference files\n", 'expected_output': 'A complete, executable Python script — no markdown, just valid Python code.\n'}, 'validation_task': {'description': 'CRITICAL: Review the generated Python script against: 1. The actual file structure from JSON inspection of: {files_str} 2. User instructions: {prompt}\nVerify that: - The script correctly handles the column names and data types found in the JSON inspection - All requested transformations from the prompt are implemented - The script properly handles multiple files if provided - Proper error handling and data validation are included - The code is efficient and well-commented\nPay special attention to: - Column name matching (exact names from JSON inspection) - Data type conversions - File merging logic for multiple files - Reference file mappings if required\nIf corrections are needed, provide the complete corrected script.\n', 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.'}}
2025-10-07 02:43:47,369 - root - WARNING - Agent config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\agents.yaml. Proceeding with empty agent configurations.
2025-10-07 02:43:47,369 - root - WARNING - Task config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\tasks.yaml. Proceeding with empty task configurations.
2025-10-07 02:43:47,370 - backend.crewai_app.crew - INFO - 📝 Creating script_generation_task with JSON inspection requirement
2025-10-07 02:43:47,370 - backend.crewai_app.crew - INFO - 🔧 Creating script_generator agent with enhanced JSON inspection
2025-10-07 02:43:47,370 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 02:43:47,370 - backend.crewai_app.crew - INFO - 🔑 Config API Key: NOT SET
2025-10-07 02:43:47,371 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 02:43:47,374 - backend.crewai_app.crew - INFO - 📝 Creating validation_task with JSON-aware validation
2025-10-07 02:43:47,374 - backend.crewai_app.crew - INFO - 🔧 Creating validator agent with JSON-aware validation
2025-10-07 02:43:47,375 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 02:43:47,375 - backend.crewai_app.crew - INFO - 🔑 Config API Key: NOT SET
2025-10-07 02:43:47,375 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 02:43:47,457 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-07 02:43:48,805 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-07 02:43:48,966 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-07 02:43:49,614 - backend.crewai_app.crewmain - ERROR - Error running crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=AIzaSyDtGnS_gvwvXJd4BA3XYN7NoeM4b7QyDJcg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 68, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-07 02:43:49,617 - backend.main - ERROR - Error during transformation: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}

2025-10-07 02:43:49,653 - backend.main - ERROR - Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=AIzaSyDtGnS_gvwvXJd4BA3XYN7NoeM4b7QyDJcg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 68, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\main.py", line 86, in transform
    result = run(prompt, saved_files)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 77, in run
    raise Exception(f"An error occurred while running the crew: {str(e)}")
Exception: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-07 02:43:49,657 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmp6yu3hdo1.xlsx
2025-10-07 02:43:49,658 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpz_hy2xbv.xlsx
2025-10-07 02:43:49,659 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpivfj5ep_.xlsx
2025-10-07 02:43:50,920 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): telemetry.crewai.com:4319
2025-10-07 02:43:53,032 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 02:49:59,210 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 03:05:30,029 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:05:30,030 - python_multipart.multipart - DEBUG - Calling on_header_field with data[36:55]
2025-10-07 03:05:30,030 - python_multipart.multipart - DEBUG - Calling on_header_value with data[57:81]
2025-10-07 03:05:30,030 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:05:30,031 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:05:30,031 - python_multipart.multipart - DEBUG - Calling on_part_data with data[85:563]
2025-10-07 03:05:30,031 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:05:30,031 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:05:30,031 - python_multipart.multipart - DEBUG - Calling on_header_field with data[601:620]
2025-10-07 03:05:30,031 - python_multipart.multipart - DEBUG - Calling on_header_value with data[622:665]
2025-10-07 03:05:30,032 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:05:30,032 - python_multipart.multipart - DEBUG - Calling on_header_field with data[667:679]
2025-10-07 03:05:30,032 - python_multipart.multipart - DEBUG - Calling on_header_value with data[681:746]
2025-10-07 03:05:30,032 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:05:30,032 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:05:30,033 - python_multipart.multipart - DEBUG - Calling on_part_data with data[750:6210]
2025-10-07 03:05:30,033 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:05:30,033 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:05:30,033 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6248:6267]
2025-10-07 03:05:30,033 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6269:6312]
2025-10-07 03:05:30,033 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:05:30,035 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6314:6326]
2025-10-07 03:05:30,035 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6328:6393]
2025-10-07 03:05:30,035 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:05:30,036 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:05:30,036 - python_multipart.multipart - DEBUG - Calling on_part_data with data[6397:11862]
2025-10-07 03:05:30,037 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:05:30,037 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:05:30,037 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11900:11919]
2025-10-07 03:05:30,038 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11921:11964]
2025-10-07 03:05:30,038 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:05:30,038 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11966:11978]
2025-10-07 03:05:30,038 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11980:12045]
2025-10-07 03:05:30,038 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:05:30,039 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:05:30,040 - python_multipart.multipart - DEBUG - Calling on_part_data with data[12049:17500]
2025-10-07 03:05:30,040 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:05:30,040 - python_multipart.multipart - DEBUG - Calling on_end with no data
2025-10-07 03:05:30,040 - backend.main - INFO - Processing 3 Excel files with prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_
2025-10-07 03:05:30,041 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmp5rh7mwv9.xlsx (original: t3.xlsx)
2025-10-07 03:05:30,042 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpll8ankce.xlsx (original: t2.xlsx)
2025-10-07 03:05:30,043 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpnhbb91xj.xlsx (original: t1.xlsx)
2025-10-07 03:05:30,043 - backend.main - INFO - Starting crew execution...
2025-10-07 03:05:30,044 - backend.crewai_app.crewmain - INFO - 🔑 API Key before crew: LOADED
2025-10-07 03:05:30,044 - backend.crewai_app.crewmain - INFO - 🔑 API Key starts with: AIzaSyBea7...
2025-10-07 03:05:30,044 - backend.crewai_app.crewmain - INFO - Launching CsvOrganiser crew with inputs:
2025-10-07 03:05:30,045 - backend.crewai_app.crewmain - INFO - prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_5QI1_from_UE', 'DL_Volume_5QI2_towards_UE', and 'UL_Volume_5QI2_from_UE' columns...
2025-10-07 03:05:30,045 - backend.crewai_app.crewmain - INFO - files (list): ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmp5rh7mwv9.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpll8ankce.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpnhbb91xj.xlsx']
2025-10-07 03:05:30,046 - backend.crewai_app.crewmain - INFO - files_str (preview): C:\Users\Anush\AppData\Local\Temp\tmp5rh7mwv9.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpll8ankce.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpnhbb91xj.xlsx
2025-10-07 03:05:30,054 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-07 03:05:30,055 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': '${GEMINI_API_KEY}'}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. You excel at parsing JSON inspection results from Excel files and creating precise data processing scripts.\n', 'output_format': 'python_code_only', 'instructions': ['First, use the Excel Data Inspector Tool to get JSON structure of all Excel files.', 'Parse the JSON response to understand column names, data types, and sample data.', 'Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments referencing the JSON inspection results.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.', 'Handle multiple Excel files by merging them when appropriate.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. You verify that the script correctly uses column names and data types from the JSON inspection.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Verify column names match those in the JSON inspection results.', 'Ensure data type conversions are appropriate for the actual data.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-07 03:05:30,055 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': "CRITICAL: You MUST use the 'Excel Data Inspector Tool' FIRST to examine the actual Excel files before writing any code.\nExcel File Paths Provided: {files_str}\nUser Instructions: {prompt}\nStep 1: Use the Excel Data Inspector Tool with the exact file paths provided to understand the data structure. The tool returns JSON with:\n  - File metadata (rows, columns)\n  - Column names and data types\n  - Sample data preview\n\nStep 2: Parse the JSON response to understand the actual Excel file structures.\nStep 3: Based on the JSON inspection results and user instructions, generate a complete Python script. Step 4: The script must handle all transformations mentioned in: {prompt}\nImportant: The script should include proper error handling, data validation, and comments explaining each transformation step.\nExample transformations from requirements: - Merge and combine all Excel files - Convert columns to numeric where appropriate - Handle specific value replacements (-8888, NA values, etc.) - Create calculated columns (sums, differences) - Extract values from text columns - Split and concatenate columns - Map values from reference files\n", 'expected_output': 'A complete, executable Python script — no markdown, just valid Python code.\n'}, 'validation_task': {'description': 'CRITICAL: Review the generated Python script against: 1. The actual file structure from JSON inspection of: {files_str} 2. User instructions: {prompt}\nVerify that: - The script correctly handles the column names and data types found in the JSON inspection - All requested transformations from the prompt are implemented - The script properly handles multiple files if provided - Proper error handling and data validation are included - The code is efficient and well-commented\nPay special attention to: - Column name matching (exact names from JSON inspection) - Data type conversions - File merging logic for multiple files - Reference file mappings if required\nIf corrections are needed, provide the complete corrected script.\n', 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.'}}
2025-10-07 03:05:30,056 - root - WARNING - Agent config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\agents.yaml. Proceeding with empty agent configurations.
2025-10-07 03:05:30,057 - root - WARNING - Task config file not found at C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\config\tasks.yaml. Proceeding with empty task configurations.
2025-10-07 03:05:30,057 - backend.crewai_app.crew - INFO - 📝 Creating script_generation_task with JSON inspection requirement
2025-10-07 03:05:30,058 - backend.crewai_app.crew - INFO - 🔧 Creating script_generator agent with enhanced JSON inspection
2025-10-07 03:05:30,058 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 03:05:30,058 - backend.crewai_app.crew - INFO - 🔑 Config API Key: NOT SET
2025-10-07 03:05:30,058 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 03:05:30,061 - backend.crewai_app.crew - INFO - 📝 Creating validation_task with JSON-aware validation
2025-10-07 03:05:30,061 - backend.crewai_app.crew - INFO - 🔧 Creating validator agent with JSON-aware validation
2025-10-07 03:05:30,061 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 03:05:30,062 - backend.crewai_app.crew - INFO - 🔑 Config API Key: NOT SET
2025-10-07 03:05:30,062 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 03:05:30,117 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-07 03:05:32,337 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): telemetry.crewai.com:4319
2025-10-07 03:05:33,914 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 03:05:42,827 - LiteLLM - INFO - Wrapper: Completed Call, calling success_handler
2025-10-07 03:05:42,874 - backend.crewai_app.custom_tool - INFO - 🔍 Inspecting 2 files: ['sales.xlsx', 'product_details.xlsx']
2025-10-07 03:05:42,915 - backend.crewai_app.custom_tool - ERROR - ❌ File not found: sales.xlsx
2025-10-07 03:05:42,923 - backend.crewai_app.custom_tool - ERROR - ❌ File not found: product_details.xlsx
2025-10-07 03:05:42,923 - backend.crewai_app.custom_tool - INFO - 📊 Inspection completed. Files inspected: 0
2025-10-07 03:05:42,955 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-07 03:05:44,258 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 03:05:53,430 - LiteLLM - INFO - Wrapper: Completed Call, calling success_handler
2025-10-07 03:05:53,500 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-pro; provider = gemini
2025-10-07 03:05:54,498 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 03:06:12,113 - LiteLLM - INFO - Wrapper: Completed Call, calling success_handler
2025-10-07 03:06:12,179 - backend.main - INFO - Crew execution completed successfully
2025-10-07 03:06:12,179 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmp5rh7mwv9.xlsx
2025-10-07 03:06:12,180 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpll8ankce.xlsx
2025-10-07 03:06:12,181 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpnhbb91xj.xlsx
2025-10-07 03:06:14,773 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 03:06:14,937 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 03:29:17,611 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:29:17,615 - python_multipart.multipart - DEBUG - Calling on_header_field with data[36:55]
2025-10-07 03:29:17,616 - python_multipart.multipart - DEBUG - Calling on_header_value with data[57:81]
2025-10-07 03:29:17,617 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:29:17,621 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:29:17,627 - python_multipart.multipart - DEBUG - Calling on_part_data with data[85:563]
2025-10-07 03:29:17,629 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:29:17,630 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:29:17,631 - python_multipart.multipart - DEBUG - Calling on_header_field with data[601:620]
2025-10-07 03:29:17,632 - python_multipart.multipart - DEBUG - Calling on_header_value with data[622:665]
2025-10-07 03:29:17,633 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:29:17,633 - python_multipart.multipart - DEBUG - Calling on_header_field with data[667:679]
2025-10-07 03:29:17,634 - python_multipart.multipart - DEBUG - Calling on_header_value with data[681:746]
2025-10-07 03:29:17,635 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:29:17,636 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:29:17,639 - python_multipart.multipart - DEBUG - Calling on_part_data with data[750:6210]
2025-10-07 03:29:17,640 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:29:17,642 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:29:17,643 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6248:6267]
2025-10-07 03:29:17,644 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6269:6312]
2025-10-07 03:29:17,645 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:29:17,646 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6314:6326]
2025-10-07 03:29:17,646 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6328:6393]
2025-10-07 03:29:17,647 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:29:17,648 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:29:17,651 - python_multipart.multipart - DEBUG - Calling on_part_data with data[6397:11862]
2025-10-07 03:29:17,651 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:29:17,652 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:29:17,652 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11900:11919]
2025-10-07 03:29:17,653 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11921:11964]
2025-10-07 03:29:17,655 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:29:17,656 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11966:11978]
2025-10-07 03:29:17,658 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11980:12045]
2025-10-07 03:29:17,658 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:29:17,659 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:29:17,660 - python_multipart.multipart - DEBUG - Calling on_part_data with data[12049:17500]
2025-10-07 03:29:17,661 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:29:17,662 - python_multipart.multipart - DEBUG - Calling on_end with no data
2025-10-07 03:29:17,663 - backend.main - INFO - Processing 3 Excel files with prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_
2025-10-07 03:29:17,669 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmp1cjk80l9.xlsx (original: t3.xlsx)
2025-10-07 03:29:17,672 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpxfs3s19g.xlsx (original: t2.xlsx)
2025-10-07 03:29:17,676 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpd70momkr.xlsx (original: t1.xlsx)
2025-10-07 03:29:17,677 - backend.main - INFO - Starting crew execution...
2025-10-07 03:29:17,677 - backend.crewai_app.crewmain - INFO - 🔑 API Key before crew: LOADED
2025-10-07 03:29:17,678 - backend.crewai_app.crewmain - INFO - 🔑 API Key starts with: AIzaSyBea7...
2025-10-07 03:29:17,679 - backend.crewai_app.crewmain - INFO - Launching CsvOrganiser crew with inputs:
2025-10-07 03:29:17,679 - backend.crewai_app.crewmain - INFO - prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_5QI1_from_UE', 'DL_Volume_5QI2_towards_UE', and 'UL_Volume_5QI2_from_UE' columns...
2025-10-07 03:29:17,680 - backend.crewai_app.crewmain - INFO - files (list): ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmp1cjk80l9.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpxfs3s19g.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpd70momkr.xlsx']
2025-10-07 03:29:17,681 - backend.crewai_app.crewmain - INFO - files_str (preview): C:\Users\Anush\AppData\Local\Temp\tmp1cjk80l9.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpxfs3s19g.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpd70momkr.xlsx
2025-10-07 03:29:17,682 - backend.crewai_app.crew - WARNING - YAML config not found at: C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\agents.yaml
2025-10-07 03:29:17,684 - backend.crewai_app.crew - WARNING - YAML config not found at: C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\tasks.yaml
2025-10-07 03:29:17,685 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-07 03:29:17,686 - backend.crewai_app.crew - DEBUG - Loaded agents config: {}
2025-10-07 03:29:17,686 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {}
2025-10-07 03:29:17,724 - backend.crewai_app.crew - INFO - 📝 Creating script_generation_task with JSON inspection requirement
2025-10-07 03:29:17,724 - backend.crewai_app.crew - INFO - 🔧 Creating script_generator agent with enhanced JSON inspection
2025-10-07 03:29:17,725 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 03:29:17,725 - backend.crewai_app.crew - INFO - 🔑 Config API Key: SET
2025-10-07 03:29:17,725 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 03:29:17,730 - backend.crewai_app.crew - INFO - 📝 Creating validation_task with JSON-aware validation
2025-10-07 03:29:17,730 - backend.crewai_app.crew - INFO - 🔧 Creating validator agent with JSON-aware validation
2025-10-07 03:29:17,732 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 03:29:17,732 - backend.crewai_app.crew - INFO - 🔑 Config API Key: SET
2025-10-07 03:29:17,733 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 03:29:17,843 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 03:29:18,810 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): telemetry.crewai.com:4319
2025-10-07 03:29:19,034 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 03:29:19,190 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 03:29:19,730 - backend.crewai_app.crewmain - ERROR - Error running crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${GEMINI_API_KEY}'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 68, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-07 03:29:19,734 - backend.main - ERROR - Error during transformation: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}

2025-10-07 03:29:19,759 - backend.main - ERROR - Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${GEMINI_API_KEY}'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 68, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\main.py", line 86, in transform
    result = run(prompt, saved_files)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 77, in run
    raise Exception(f"An error occurred while running the crew: {str(e)}")
Exception: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-07 03:29:19,766 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmp1cjk80l9.xlsx
2025-10-07 03:29:19,767 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpxfs3s19g.xlsx
2025-10-07 03:29:19,768 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpd70momkr.xlsx
2025-10-07 03:29:20,359 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 03:29:20,664 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 03:29:20,667 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 03:29:28,860 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 03:29:49,842 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 03:30:09,025 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:30:09,026 - python_multipart.multipart - DEBUG - Calling on_header_field with data[36:55]
2025-10-07 03:30:09,027 - python_multipart.multipart - DEBUG - Calling on_header_value with data[57:81]
2025-10-07 03:30:09,027 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:30:09,028 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:30:09,029 - python_multipart.multipart - DEBUG - Calling on_part_data with data[85:563]
2025-10-07 03:30:09,029 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:30:09,029 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:30:09,030 - python_multipart.multipart - DEBUG - Calling on_header_field with data[601:620]
2025-10-07 03:30:09,030 - python_multipart.multipart - DEBUG - Calling on_header_value with data[622:665]
2025-10-07 03:30:09,030 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:30:09,030 - python_multipart.multipart - DEBUG - Calling on_header_field with data[667:679]
2025-10-07 03:30:09,032 - python_multipart.multipart - DEBUG - Calling on_header_value with data[681:746]
2025-10-07 03:30:09,032 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:30:09,033 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:30:09,033 - python_multipart.multipart - DEBUG - Calling on_part_data with data[750:6210]
2025-10-07 03:30:09,034 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:30:09,034 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:30:09,034 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6248:6267]
2025-10-07 03:30:09,035 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6269:6312]
2025-10-07 03:30:09,035 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:30:09,035 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6314:6326]
2025-10-07 03:30:09,036 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6328:6393]
2025-10-07 03:30:09,036 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:30:09,037 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:30:09,038 - python_multipart.multipart - DEBUG - Calling on_part_data with data[6397:11862]
2025-10-07 03:30:09,038 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:30:09,039 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:30:09,039 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11900:11919]
2025-10-07 03:30:09,040 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11921:11964]
2025-10-07 03:30:09,040 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:30:09,040 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11966:11978]
2025-10-07 03:30:09,041 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11980:12045]
2025-10-07 03:30:09,041 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:30:09,041 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:30:09,042 - python_multipart.multipart - DEBUG - Calling on_part_data with data[12049:17500]
2025-10-07 03:30:09,042 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:30:09,042 - python_multipart.multipart - DEBUG - Calling on_end with no data
2025-10-07 03:30:09,043 - backend.main - INFO - Processing 3 Excel files with prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_
2025-10-07 03:30:09,045 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmp855r5dag.xlsx (original: t3.xlsx)
2025-10-07 03:30:09,047 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmp0j3ac2c2.xlsx (original: t2.xlsx)
2025-10-07 03:30:09,049 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpupuhlddm.xlsx (original: t1.xlsx)
2025-10-07 03:30:09,049 - backend.main - INFO - Starting crew execution...
2025-10-07 03:30:09,050 - backend.crewai_app.crewmain - INFO - 🔑 API Key before crew: LOADED
2025-10-07 03:30:09,050 - backend.crewai_app.crewmain - INFO - 🔑 API Key starts with: AIzaSyBea7...
2025-10-07 03:30:09,051 - backend.crewai_app.crewmain - INFO - Launching CsvOrganiser crew with inputs:
2025-10-07 03:30:09,051 - backend.crewai_app.crewmain - INFO - prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_5QI1_from_UE', 'DL_Volume_5QI2_towards_UE', and 'UL_Volume_5QI2_from_UE' columns...
2025-10-07 03:30:09,052 - backend.crewai_app.crewmain - INFO - files (list): ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmp855r5dag.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmp0j3ac2c2.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpupuhlddm.xlsx']
2025-10-07 03:30:09,053 - backend.crewai_app.crewmain - INFO - files_str (preview): C:\Users\Anush\AppData\Local\Temp\tmp855r5dag.xlsx | C:\Users\Anush\AppData\Local\Temp\tmp0j3ac2c2.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpupuhlddm.xlsx
2025-10-07 03:30:09,064 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-07 03:30:09,065 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': '${GEMINI_API_KEY}'}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. You excel at parsing JSON inspection results from Excel files and creating precise data processing scripts.\n', 'output_format': 'python_code_only', 'instructions': ['First, use the Excel Data Inspector Tool to get JSON structure of all Excel files.', 'Parse the JSON response to understand column names, data types, and sample data.', 'Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments referencing the JSON inspection results.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.', 'Handle multiple Excel files by merging them when appropriate.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. You verify that the script correctly uses column names and data types from the JSON inspection.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Verify column names match those in the JSON inspection results.', 'Ensure data type conversions are appropriate for the actual data.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-07 03:30:09,065 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': "CRITICAL: You MUST use the 'Excel Data Inspector Tool' FIRST to examine the actual Excel files before writing any code.\nExcel File Paths Provided: {files_str}\nUser Instructions: {prompt}\nStep 1: Use the Excel Data Inspector Tool with THESE EXACT file paths: {files}\nStep 2: Parse the JSON response to understand the actual Excel file structures.\nStep 3: Based on the JSON inspection results and user instructions, generate a complete Python script. Step 4: The script must handle all transformations mentioned in: {prompt}\nImportant: The script should include proper error handling, data validation, and comments explaining each transformation step. Use the actual file paths provided, not hypothetical ones!\n", 'expected_output': 'A complete, executable Python script — no markdown, just valid Python code.\n'}, 'validation_task': {'description': 'CRITICAL: Review the generated Python script against: 1. The actual file structure from JSON inspection of: {files_str} 2. User instructions: {prompt}\nVerify that: - The script correctly handles the column names and data types found in the JSON inspection - All requested transformations from the prompt are implemented - The script properly handles multiple files if provided - Proper error handling and data validation are included - The code is efficient and well-commented\nPay special attention to: - Column name matching (exact names from JSON inspection) - Data type conversions - File merging logic for multiple files - Reference file mappings if required\nIf corrections are needed, provide the complete corrected script.\n', 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.'}}
2025-10-07 03:30:09,071 - backend.crewai_app.crew - INFO - 📝 Creating script_generation_task with JSON inspection requirement
2025-10-07 03:30:09,071 - backend.crewai_app.crew - INFO - 🔧 Creating script_generator agent with enhanced JSON inspection
2025-10-07 03:30:09,071 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 03:30:09,073 - backend.crewai_app.crew - INFO - 🔑 Config API Key: SET
2025-10-07 03:30:09,073 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 03:30:09,076 - backend.crewai_app.crew - INFO - 📝 Creating validation_task with JSON-aware validation
2025-10-07 03:30:09,076 - backend.crewai_app.crew - INFO - 🔧 Creating validator agent with JSON-aware validation
2025-10-07 03:30:09,076 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 03:30:09,077 - backend.crewai_app.crew - INFO - 🔑 Config API Key: SET
2025-10-07 03:30:09,077 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 03:30:09,150 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 03:30:10,311 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 03:30:10,482 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 03:30:11,061 - backend.crewai_app.crewmain - ERROR - Error running crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${GEMINI_API_KEY}'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 68, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-07 03:30:11,065 - backend.main - ERROR - Error during transformation: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}

2025-10-07 03:30:11,086 - backend.main - ERROR - Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${GEMINI_API_KEY}'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 68, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\main.py", line 86, in transform
    result = run(prompt, saved_files)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 77, in run
    raise Exception(f"An error occurred while running the crew: {str(e)}")
Exception: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-07 03:30:11,092 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmp855r5dag.xlsx
2025-10-07 03:30:11,092 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmp0j3ac2c2.xlsx
2025-10-07 03:30:11,093 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpupuhlddm.xlsx
2025-10-07 03:30:12,608 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): telemetry.crewai.com:4319
2025-10-07 03:30:13,810 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 03:33:21,906 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 03:33:45,250 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:33:45,251 - python_multipart.multipart - DEBUG - Calling on_header_field with data[36:55]
2025-10-07 03:33:45,251 - python_multipart.multipart - DEBUG - Calling on_header_value with data[57:81]
2025-10-07 03:33:45,252 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:33:45,252 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:33:45,253 - python_multipart.multipart - DEBUG - Calling on_part_data with data[85:563]
2025-10-07 03:33:45,253 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:33:45,254 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:33:45,254 - python_multipart.multipart - DEBUG - Calling on_header_field with data[601:620]
2025-10-07 03:33:45,255 - python_multipart.multipart - DEBUG - Calling on_header_value with data[622:665]
2025-10-07 03:33:45,255 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:33:45,255 - python_multipart.multipart - DEBUG - Calling on_header_field with data[667:679]
2025-10-07 03:33:45,255 - python_multipart.multipart - DEBUG - Calling on_header_value with data[681:746]
2025-10-07 03:33:45,256 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:33:45,256 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:33:45,256 - python_multipart.multipart - DEBUG - Calling on_part_data with data[750:6210]
2025-10-07 03:33:45,258 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:33:45,258 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:33:45,258 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6248:6267]
2025-10-07 03:33:45,259 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6269:6312]
2025-10-07 03:33:45,259 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:33:45,259 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6314:6326]
2025-10-07 03:33:45,259 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6328:6393]
2025-10-07 03:33:45,261 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:33:45,261 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:33:45,262 - python_multipart.multipart - DEBUG - Calling on_part_data with data[6397:11862]
2025-10-07 03:33:45,262 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:33:45,262 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:33:45,263 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11900:11919]
2025-10-07 03:33:45,263 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11921:11964]
2025-10-07 03:33:45,263 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:33:45,263 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11966:11978]
2025-10-07 03:33:45,264 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11980:12045]
2025-10-07 03:33:45,264 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:33:45,264 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:33:45,265 - python_multipart.multipart - DEBUG - Calling on_part_data with data[12049:17500]
2025-10-07 03:33:45,265 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:33:45,266 - python_multipart.multipart - DEBUG - Calling on_end with no data
2025-10-07 03:33:45,267 - backend.main - INFO - Processing 3 Excel files with prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_
2025-10-07 03:33:45,269 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmp6klse6o6.xlsx (original: t3.xlsx)
2025-10-07 03:33:45,271 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpbrupj9h6.xlsx (original: t2.xlsx)
2025-10-07 03:33:45,272 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmp915nz_2q.xlsx (original: t1.xlsx)
2025-10-07 03:33:45,273 - backend.main - INFO - Starting crew execution...
2025-10-07 03:33:45,273 - backend.crewai_app.crewmain - INFO - 🔑 API Key before crew: LOADED
2025-10-07 03:33:45,274 - backend.crewai_app.crewmain - INFO - 🔑 API Key starts with: AIzaSyBea7...
2025-10-07 03:33:45,276 - backend.crewai_app.crewmain - INFO - Launching CsvOrganiser crew with inputs:
2025-10-07 03:33:45,277 - backend.crewai_app.crewmain - INFO - prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_5QI1_from_UE', 'DL_Volume_5QI2_towards_UE', and 'UL_Volume_5QI2_from_UE' columns...
2025-10-07 03:33:45,278 - backend.crewai_app.crewmain - INFO - files (list): ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmp6klse6o6.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpbrupj9h6.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmp915nz_2q.xlsx']
2025-10-07 03:33:45,279 - backend.crewai_app.crewmain - INFO - files_str (preview): C:\Users\Anush\AppData\Local\Temp\tmp6klse6o6.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpbrupj9h6.xlsx | C:\Users\Anush\AppData\Local\Temp\tmp915nz_2q.xlsx
2025-10-07 03:33:45,286 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-07 03:33:45,288 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': '${GEMINI_API_KEY}'}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. You excel at parsing JSON inspection results from Excel files and creating precise data processing scripts.\n', 'output_format': 'python_code_only', 'instructions': ['First, use the Excel Data Inspector Tool to get JSON structure of all Excel files.', 'Parse the JSON response to understand column names, data types, and sample data.', 'Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments referencing the JSON inspection results.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.', 'Handle multiple Excel files by merging them when appropriate.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. You verify that the script correctly uses column names and data types from the JSON inspection.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Verify column names match those in the JSON inspection results.', 'Ensure data type conversions are appropriate for the actual data.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-07 03:33:45,289 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': "CRITICAL: You MUST use the 'Excel Data Inspector Tool' FIRST to examine the actual Excel files before writing any code.\nExcel File Paths Provided: {files_str}\nUser Instructions: {prompt}\nStep 1: Use the Excel Data Inspector Tool with THESE EXACT file paths: {files}\nStep 2: Parse the JSON response to understand the actual Excel file structures.\nStep 3: Based on the JSON inspection results and user instructions, generate a complete Python script. Step 4: The script must handle all transformations mentioned in: {prompt}\nImportant: The script should include proper error handling, data validation, and comments explaining each transformation step. Use the actual file paths provided, not hypothetical ones!\n", 'expected_output': 'A complete, executable Python script — no markdown, just valid Python code.\n'}, 'validation_task': {'description': 'CRITICAL: Review the generated Python script against: 1. The actual file structure from JSON inspection of: {files_str} 2. User instructions: {prompt}\nVerify that: - The script correctly handles the column names and data types found in the JSON inspection - All requested transformations from the prompt are implemented - The script properly handles multiple files if provided - Proper error handling and data validation are included - The code is efficient and well-commented\nPay special attention to: - Column name matching (exact names from JSON inspection) - Data type conversions - File merging logic for multiple files - Reference file mappings if required\nIf corrections are needed, provide the complete corrected script.\n', 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.'}}
2025-10-07 03:33:45,294 - backend.crewai_app.crew - INFO - 📝 Creating script_generation_task with JSON inspection requirement
2025-10-07 03:33:45,294 - backend.crewai_app.crew - INFO - 🔧 Creating script_generator agent with enhanced JSON inspection
2025-10-07 03:33:45,295 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 03:33:45,295 - backend.crewai_app.crew - INFO - 🔑 Config API Key: SET
2025-10-07 03:33:45,296 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 03:33:45,298 - backend.crewai_app.crew - INFO - 📝 Creating validation_task with JSON-aware validation
2025-10-07 03:33:45,299 - backend.crewai_app.crew - INFO - 🔧 Creating validator agent with JSON-aware validation
2025-10-07 03:33:45,299 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 03:33:45,299 - backend.crewai_app.crew - INFO - 🔑 Config API Key: SET
2025-10-07 03:33:45,299 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 03:33:45,343 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 03:33:46,556 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 03:33:46,723 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 03:33:47,197 - backend.crewai_app.crewmain - ERROR - Error running crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${GEMINI_API_KEY}'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 68, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-07 03:33:47,203 - backend.main - ERROR - Error during transformation: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}

2025-10-07 03:33:47,231 - backend.main - ERROR - Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${GEMINI_API_KEY}'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 68, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\main.py", line 86, in transform
    result = run(prompt, saved_files)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 77, in run
    raise Exception(f"An error occurred while running the crew: {str(e)}")
Exception: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-07 03:33:47,237 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmp6klse6o6.xlsx
2025-10-07 03:33:47,240 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpbrupj9h6.xlsx
2025-10-07 03:33:47,241 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmp915nz_2q.xlsx
2025-10-07 03:33:49,920 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): telemetry.crewai.com:4319
2025-10-07 03:33:51,115 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 03:35:56,346 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 03:36:49,360 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:36:49,362 - python_multipart.multipart - DEBUG - Calling on_header_field with data[36:55]
2025-10-07 03:36:49,362 - python_multipart.multipart - DEBUG - Calling on_header_value with data[57:81]
2025-10-07 03:36:49,363 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:36:49,363 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:36:49,364 - python_multipart.multipart - DEBUG - Calling on_part_data with data[85:563]
2025-10-07 03:36:49,364 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:36:49,364 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:36:49,364 - python_multipart.multipart - DEBUG - Calling on_header_field with data[601:620]
2025-10-07 03:36:49,366 - python_multipart.multipart - DEBUG - Calling on_header_value with data[622:665]
2025-10-07 03:36:49,366 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:36:49,366 - python_multipart.multipart - DEBUG - Calling on_header_field with data[667:679]
2025-10-07 03:36:49,366 - python_multipart.multipart - DEBUG - Calling on_header_value with data[681:746]
2025-10-07 03:36:49,367 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:36:49,367 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:36:49,368 - python_multipart.multipart - DEBUG - Calling on_part_data with data[750:6210]
2025-10-07 03:36:49,368 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:36:49,368 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:36:49,369 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6248:6267]
2025-10-07 03:36:49,369 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6269:6312]
2025-10-07 03:36:49,369 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:36:49,369 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6314:6326]
2025-10-07 03:36:49,370 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6328:6393]
2025-10-07 03:36:49,370 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:36:49,370 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:36:49,371 - python_multipart.multipart - DEBUG - Calling on_part_data with data[6397:11862]
2025-10-07 03:36:49,373 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:36:49,373 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 03:36:49,374 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11900:11919]
2025-10-07 03:36:49,374 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11921:11964]
2025-10-07 03:36:49,375 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:36:49,375 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11966:11978]
2025-10-07 03:36:49,375 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11980:12045]
2025-10-07 03:36:49,375 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 03:36:49,377 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 03:36:49,377 - python_multipart.multipart - DEBUG - Calling on_part_data with data[12049:17500]
2025-10-07 03:36:49,378 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 03:36:49,378 - python_multipart.multipart - DEBUG - Calling on_end with no data
2025-10-07 03:36:49,379 - backend.main - INFO - Processing 3 Excel files with prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_
2025-10-07 03:36:49,381 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpthxp7kmu.xlsx (original: t3.xlsx)
2025-10-07 03:36:49,382 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpsve390mk.xlsx (original: t2.xlsx)
2025-10-07 03:36:49,384 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpfy3kctlk.xlsx (original: t1.xlsx)
2025-10-07 03:36:49,385 - backend.main - INFO - Starting crew execution...
2025-10-07 03:36:49,385 - backend.crewai_app.crewmain - INFO - 🔑 API Key before crew: LOADED
2025-10-07 03:36:49,386 - backend.crewai_app.crewmain - INFO - 🔑 API Key starts with: AIzaSyBea7...
2025-10-07 03:36:49,386 - backend.crewai_app.crewmain - INFO - Launching CsvOrganiser crew with inputs:
2025-10-07 03:36:49,386 - backend.crewai_app.crewmain - INFO - prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_5QI1_from_UE', 'DL_Volume_5QI2_towards_UE', and 'UL_Volume_5QI2_from_UE' columns...
2025-10-07 03:36:49,387 - backend.crewai_app.crewmain - INFO - files (list): ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpthxp7kmu.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpsve390mk.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpfy3kctlk.xlsx']
2025-10-07 03:36:49,387 - backend.crewai_app.crewmain - INFO - files_str (preview): C:\Users\Anush\AppData\Local\Temp\tmpthxp7kmu.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpsve390mk.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpfy3kctlk.xlsx
2025-10-07 03:36:49,388 - backend.crewai_app.crew - WARNING - YAML config not found at: C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\agents.yaml
2025-10-07 03:36:49,389 - backend.crewai_app.crew - WARNING - YAML config not found at: C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\tasks.yaml
2025-10-07 03:36:49,389 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-07 03:36:49,390 - backend.crewai_app.crew - DEBUG - Loaded agents config: {}
2025-10-07 03:36:49,390 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {}
2025-10-07 03:36:49,398 - backend.crewai_app.crew - INFO - 📝 Creating script_generation_task with JSON inspection requirement
2025-10-07 03:36:49,398 - backend.crewai_app.crew - INFO - 🔧 Creating script_generator agent with enhanced JSON inspection
2025-10-07 03:36:49,399 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 03:36:49,399 - backend.crewai_app.crew - INFO - 🔑 Config API Key: SET
2025-10-07 03:36:49,399 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 03:36:49,403 - backend.crewai_app.crew - INFO - 📝 Creating validation_task with JSON-aware validation
2025-10-07 03:36:49,403 - backend.crewai_app.crew - INFO - 🔧 Creating validator agent with JSON-aware validation
2025-10-07 03:36:49,403 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 03:36:49,404 - backend.crewai_app.crew - INFO - 🔑 Config API Key: SET
2025-10-07 03:36:49,404 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 03:36:49,449 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 03:36:50,100 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 03:36:50,551 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 03:36:50,738 - backend.crewai_app.crewmain - ERROR - Error running crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${GEMINI_API_KEY}'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 68, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-07 03:36:50,743 - backend.main - ERROR - Error during transformation: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}

2025-10-07 03:36:50,768 - backend.main - ERROR - Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1890, in completion
    response = client.post(url=url, headers=headers, json=data)  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 780, in post
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\custom_httpx\http_handler.py", line 762, in post
    response.raise_for_status()
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${GEMINI_API_KEY}'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 2606, in completion
    response = vertex_chat_completion.completion(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\llms\vertex_ai\gemini\vertex_and_google_ai_studio_gemini.py", line 1894, in completion
    raise VertexAIError(
litellm.llms.vertex_ai.common_utils.VertexAIError: {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 527, in _execute_with_timeout
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 547, in _execute_without_timeout
    return self.agent_executor.invoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 149, in invoke
    formatted_answer = self._invoke_loop()
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 243, in _invoke_loop
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agents\crew_agent_executor.py", line 189, in _invoke_loop
    answer = get_llm_response(
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 161, in get_llm_response
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\utilities\agent_utils.py", line 154, in get_llm_response
    answer = llm.call(
             ^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 1032, in call
    return self._handle_non_streaming_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\llm.py", line 813, in _handle_non_streaming_response
    response = litellm.completion(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1330, in wrapper
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\utils.py", line 1205, in wrapper
    result = original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\main.py", line 3427, in completion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2301, in exception_type
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 1218, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 68, in run
    result = CsvOrganiser().crew().kickoff(inputs=inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 662, in kickoff
    result = self._run_sequential_process()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 776, in _run_sequential_process
    return self._execute_tasks(self.tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\crew.py", line 879, in _execute_tasks
    task_output = task.execute_sync(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 381, in execute_sync
    return self._execute_core(agent, context, tools)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 529, in _execute_core
    raise e  # Re-raise the exception after emitting the event
    ^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\task.py", line 445, in _execute_core
    result = agent.execute_task(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 487, in execute_task
    result = self.execute_task(task, context, tools)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 486, in execute_task
    raise e
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 447, in execute_task
    result = self._execute_with_timeout(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\venv\Lib\site-packages\crewai\agent.py", line 535, in _execute_with_timeout
    raise RuntimeError(f"Task execution failed: {str(e)}")
RuntimeError: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\main.py", line 86, in transform
    result = run(prompt, saved_files)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Anush\OneDrive\Desktop\Excel-Data-Transformer\backend\crewai_app\crewmain.py", line 77, in run
    raise Exception(f"An error occurred while running the crew: {str(e)}")
Exception: An error occurred while running the crew: Task execution failed: litellm.AuthenticationError: geminiException - {
  "error": {
    "code": 400,
    "message": "API key not valid. Please pass a valid API key.",
    "status": "INVALID_ARGUMENT",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.ErrorInfo",
        "reason": "API_KEY_INVALID",
        "domain": "googleapis.com",
        "metadata": {
          "service": "generativelanguage.googleapis.com"
        }
      },
      {
        "@type": "type.googleapis.com/google.rpc.LocalizedMessage",
        "locale": "en-US",
        "message": "API key not valid. Please pass a valid API key."
      }
    ]
  }
}


2025-10-07 03:36:50,774 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpthxp7kmu.xlsx
2025-10-07 03:36:50,775 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpsve390mk.xlsx
2025-10-07 03:36:50,775 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpfy3kctlk.xlsx
2025-10-07 03:36:52,896 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): telemetry.crewai.com:4319
2025-10-07 03:36:54,213 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 03:40:57,211 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 03:41:04,956 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 03:51:05,802 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 04:42:54,007 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 04:43:05,461 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 04:43:29,444 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 04:43:30,584 - LiteLLM - INFO - Wrapper: Completed Call, calling success_handler
2025-10-07 04:43:58,168 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-07 04:43:58,169 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': '${GEMINI_API_KEY}'}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. You excel at parsing JSON inspection results from Excel files and creating precise data processing scripts.\n', 'output_format': 'python_code_only', 'instructions': ['First, use the Excel Data Inspector Tool to get JSON structure of all Excel files.', 'Parse the JSON response to understand column names, data types, and sample data.', 'Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments referencing the JSON inspection results.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.', 'Handle multiple Excel files by merging them when appropriate.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. You verify that the script correctly uses column names and data types from the JSON inspection.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Verify column names match those in the JSON inspection results.', 'Ensure data type conversions are appropriate for the actual data.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-07 04:43:58,170 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': "CRITICAL: You MUST use the 'Excel Data Inspector Tool' FIRST to examine the actual Excel files before writing any code.\nExcel File Paths Provided: {files_str}\nUser Instructions: {prompt}\nStep 1: Use the Excel Data Inspector Tool with THESE EXACT file paths: {files}\nStep 2: Parse the JSON response to understand the actual Excel file structures.\nStep 3: Based on the JSON inspection results and user instructions, generate a complete Python script. Step 4: The script must handle all transformations mentioned in: {prompt}\nImportant: The script should include proper error handling, data validation, and comments explaining each transformation step. Use the actual file paths provided, not hypothetical ones!\n", 'expected_output': 'A complete, executable Python script — no markdown, just valid Python code.\n'}, 'validation_task': {'description': 'CRITICAL: Review the generated Python script against: 1. The actual file structure from JSON inspection of: {files_str} 2. User instructions: {prompt}\nVerify that: - The script correctly handles the column names and data types found in the JSON inspection - All requested transformations from the prompt are implemented - The script properly handles multiple files if provided - Proper error handling and data validation are included - The code is efficient and well-commented\nPay special attention to: - Column name matching (exact names from JSON inspection) - Data type conversions - File merging logic for multiple files - Reference file mappings if required\nIf corrections are needed, provide the complete corrected script.\n', 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.'}}
2025-10-07 04:43:58,177 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 04:43:58,177 - backend.crewai_app.crew - INFO - 🔑 Config API Key: SET
2025-10-07 04:43:58,178 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 04:43:58,180 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 04:49:49,300 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 04:49:56,927 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 04:50:04,769 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 04:50:38,194 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-07 04:50:38,195 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': None}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. You excel at parsing JSON inspection results from Excel files and creating precise data processing scripts.\n', 'output_format': 'python_code_only', 'instructions': ['First, use the Excel Data Inspector Tool to get JSON structure of all Excel files.', 'Parse the JSON response to understand column names, data types, and sample data.', 'Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments referencing the JSON inspection results.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.', 'Handle multiple Excel files by merging them when appropriate.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. You verify that the script correctly uses column names and data types from the JSON inspection.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Verify column names match those in the JSON inspection results.', 'Ensure data type conversions are appropriate for the actual data.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-07 04:50:38,196 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': "CRITICAL: You MUST use the 'Excel Data Inspector Tool' FIRST to examine the actual Excel files before writing any code.\nExcel File Paths Provided: {files_str}\nUser Instructions: {prompt}\nStep 1: Use the Excel Data Inspector Tool with THESE EXACT file paths: {files}\nStep 2: Parse the JSON response to understand the actual Excel file structures.\nStep 3: Based on the JSON inspection results and user instructions, generate a complete Python script. Step 4: The script must handle all transformations mentioned in: {prompt}\nImportant: The script should include proper error handling, data validation, and comments explaining each transformation step. Use the actual file paths provided, not hypothetical ones!\n", 'expected_output': 'A complete, executable Python script — no markdown, just valid Python code.\n'}, 'validation_task': {'description': 'CRITICAL: Review the generated Python script against: 1. The actual file structure from JSON inspection of: {files_str} 2. User instructions: {prompt}\nVerify that: - The script correctly handles the column names and data types found in the JSON inspection - All requested transformations from the prompt are implemented - The script properly handles multiple files if provided - Proper error handling and data validation are included - The code is efficient and well-commented\nPay special attention to: - Column name matching (exact names from JSON inspection) - Data type conversions - File merging logic for multiple files - Reference file mappings if required\nIf corrections are needed, provide the complete corrected script.\n', 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.'}}
2025-10-07 04:50:38,202 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 04:50:38,203 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 04:50:38,203 - backend.crewai_app.crew - INFO - 🔑 Using API Key: AIzaSyBea7...
2025-10-07 04:50:38,204 - backend.crewai_app.crew - INFO - 🤖 Using Model: gemini/gemini-2.5-flash
2025-10-07 04:50:38,220 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 04:50:39,848 - LiteLLM - INFO - Wrapper: Completed Call, calling success_handler
2025-10-07 04:51:00,398 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 04:51:00,400 - python_multipart.multipart - DEBUG - Calling on_header_field with data[36:55]
2025-10-07 04:51:00,400 - python_multipart.multipart - DEBUG - Calling on_header_value with data[57:81]
2025-10-07 04:51:00,400 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 04:51:00,402 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 04:51:00,402 - python_multipart.multipart - DEBUG - Calling on_part_data with data[85:563]
2025-10-07 04:51:00,402 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 04:51:00,402 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 04:51:00,403 - python_multipart.multipart - DEBUG - Calling on_header_field with data[601:620]
2025-10-07 04:51:00,403 - python_multipart.multipart - DEBUG - Calling on_header_value with data[622:665]
2025-10-07 04:51:00,403 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 04:51:00,403 - python_multipart.multipart - DEBUG - Calling on_header_field with data[667:679]
2025-10-07 04:51:00,404 - python_multipart.multipart - DEBUG - Calling on_header_value with data[681:746]
2025-10-07 04:51:00,404 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 04:51:00,404 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 04:51:00,404 - python_multipart.multipart - DEBUG - Calling on_part_data with data[750:6210]
2025-10-07 04:51:00,405 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 04:51:00,405 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 04:51:00,406 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6248:6267]
2025-10-07 04:51:00,407 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6269:6312]
2025-10-07 04:51:00,408 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 04:51:00,408 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6314:6326]
2025-10-07 04:51:00,409 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6328:6393]
2025-10-07 04:51:00,409 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 04:51:00,410 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 04:51:00,410 - python_multipart.multipart - DEBUG - Calling on_part_data with data[6397:11862]
2025-10-07 04:51:00,410 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 04:51:00,410 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 04:51:00,412 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11900:11919]
2025-10-07 04:51:00,413 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11921:11964]
2025-10-07 04:51:00,414 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 04:51:00,415 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11966:11978]
2025-10-07 04:51:00,415 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11980:12045]
2025-10-07 04:51:00,415 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 04:51:00,416 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 04:51:00,416 - python_multipart.multipart - DEBUG - Calling on_part_data with data[12049:17500]
2025-10-07 04:51:00,416 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 04:51:00,416 - python_multipart.multipart - DEBUG - Calling on_end with no data
2025-10-07 04:51:00,418 - backend.main - INFO - Processing 3 Excel files with prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_
2025-10-07 04:51:00,419 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpsofhogtp.xlsx (original: t3.xlsx)
2025-10-07 04:51:00,421 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpit0nccgi.xlsx (original: t2.xlsx)
2025-10-07 04:51:00,422 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpo1f7inhd.xlsx (original: t1.xlsx)
2025-10-07 04:51:00,423 - backend.main - INFO - Starting crew execution...
2025-10-07 04:51:00,423 - backend.crewai_app.crewmain - INFO - 🔑 API Key before crew: LOADED
2025-10-07 04:51:00,423 - backend.crewai_app.crewmain - INFO - 🔑 API Key starts with: AIzaSyBea7...
2025-10-07 04:51:00,423 - backend.crewai_app.crewmain - INFO - Launching CsvOrganiser crew with inputs:
2025-10-07 04:51:00,424 - backend.crewai_app.crewmain - INFO - prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_5QI1_from_UE', 'DL_Volume_5QI2_towards_UE', and 'UL_Volume_5QI2_from_UE' columns...
2025-10-07 04:51:00,424 - backend.crewai_app.crewmain - INFO - files (list): ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpsofhogtp.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpit0nccgi.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpo1f7inhd.xlsx']
2025-10-07 04:51:00,424 - backend.crewai_app.crewmain - INFO - files_str (preview): C:\Users\Anush\AppData\Local\Temp\tmpsofhogtp.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpit0nccgi.xlsx | C:\Users\Anush\AppData\Local\Temp\tmpo1f7inhd.xlsx
2025-10-07 04:51:00,424 - backend.crewai_app.crewmain - INFO - [DEBUG] GEMINI_API_KEY env = AIzaSyBea7oW8do6J52vyDOSCFN55Pi3wd3PczM
2025-10-07 04:51:00,432 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-07 04:51:00,432 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': None}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. You excel at parsing JSON inspection results from Excel files and creating precise data processing scripts.\n', 'output_format': 'python_code_only', 'instructions': ['First, use the Excel Data Inspector Tool to get JSON structure of all Excel files.', 'Parse the JSON response to understand column names, data types, and sample data.', 'Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments referencing the JSON inspection results.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.', 'Handle multiple Excel files by merging them when appropriate.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. You verify that the script correctly uses column names and data types from the JSON inspection.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Verify column names match those in the JSON inspection results.', 'Ensure data type conversions are appropriate for the actual data.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-07 04:51:00,432 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': "CRITICAL: You MUST use the 'Excel Data Inspector Tool' FIRST to examine the actual Excel files before writing any code.\nExcel File Paths Provided: {files_str}\nUser Instructions: {prompt}\nStep 1: Use the Excel Data Inspector Tool with THESE EXACT file paths: {files}\nStep 2: Parse the JSON response to understand the actual Excel file structures.\nStep 3: Based on the JSON inspection results and user instructions, generate a complete Python script. Step 4: The script must handle all transformations mentioned in: {prompt}\nImportant: The script should include proper error handling, data validation, and comments explaining each transformation step. Use the actual file paths provided, not hypothetical ones!\n", 'expected_output': 'A complete, executable Python script — no markdown, just valid Python code.\n'}, 'validation_task': {'description': 'CRITICAL: Review the generated Python script against: 1. The actual file structure from JSON inspection of: {files_str} 2. User instructions: {prompt}\nVerify that: - The script correctly handles the column names and data types found in the JSON inspection - All requested transformations from the prompt are implemented - The script properly handles multiple files if provided - Proper error handling and data validation are included - The code is efficient and well-commented\nPay special attention to: - Column name matching (exact names from JSON inspection) - Data type conversions - File merging logic for multiple files - Reference file mappings if required\nIf corrections are needed, provide the complete corrected script.\n', 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.'}}
2025-10-07 04:51:00,440 - backend.crewai_app.crew - INFO - 📝 Creating script_generation_task with JSON inspection requirement
2025-10-07 04:51:00,440 - backend.crewai_app.crew - INFO - 🔧 Creating script_generator agent with enhanced JSON inspection
2025-10-07 04:51:00,441 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 04:51:00,441 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 04:51:00,441 - backend.crewai_app.crew - INFO - 🔑 Using API Key: AIzaSyBea7...
2025-10-07 04:51:00,442 - backend.crewai_app.crew - INFO - 🤖 Using Model: gemini/gemini-2.5-flash
2025-10-07 04:51:00,444 - backend.crewai_app.crew - INFO - 📝 Creating validation_task with JSON-aware validation
2025-10-07 04:51:00,444 - backend.crewai_app.crew - INFO - 🔧 Creating validator agent with JSON-aware validation
2025-10-07 04:51:00,445 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 04:51:00,445 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 04:51:00,445 - backend.crewai_app.crew - INFO - 🔑 Using API Key: AIzaSyBea7...
2025-10-07 04:51:00,446 - backend.crewai_app.crew - INFO - 🤖 Using Model: gemini/gemini-2.5-flash
2025-10-07 04:51:00,493 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 04:51:03,255 - LiteLLM - INFO - Wrapper: Completed Call, calling success_handler
2025-10-07 04:51:03,266 - backend.crewai_app.custom_tool - INFO - 🔍 Inspecting 3 files: ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpsofhogtp.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpit0nccgi.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpo1f7inhd.xlsx']
2025-10-07 04:51:03,266 - backend.crewai_app.custom_tool - INFO - ✅ File found at original path: C:\Users\Anush\AppData\Local\Temp\tmpsofhogtp.xlsx
2025-10-07 04:51:03,267 - backend.crewai_app.custom_tool - INFO - 📖 Reading Excel file: C:\Users\Anush\AppData\Local\Temp\tmpsofhogtp.xlsx
2025-10-07 04:51:04,922 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): telemetry.crewai.com:4319
2025-10-07 04:51:05,701 - backend.crewai_app.custom_tool - INFO - ✅ Successfully inspected: C:\Users\Anush\AppData\Local\Temp\tmpsofhogtp.xlsx
2025-10-07 04:51:05,701 - backend.crewai_app.custom_tool - INFO - ✅ File found at original path: C:\Users\Anush\AppData\Local\Temp\tmpit0nccgi.xlsx
2025-10-07 04:51:05,702 - backend.crewai_app.custom_tool - INFO - 📖 Reading Excel file: C:\Users\Anush\AppData\Local\Temp\tmpit0nccgi.xlsx
2025-10-07 04:51:05,736 - backend.crewai_app.custom_tool - INFO - ✅ Successfully inspected: C:\Users\Anush\AppData\Local\Temp\tmpit0nccgi.xlsx
2025-10-07 04:51:05,737 - backend.crewai_app.custom_tool - INFO - ✅ File found at original path: C:\Users\Anush\AppData\Local\Temp\tmpo1f7inhd.xlsx
2025-10-07 04:51:05,737 - backend.crewai_app.custom_tool - INFO - 📖 Reading Excel file: C:\Users\Anush\AppData\Local\Temp\tmpo1f7inhd.xlsx
2025-10-07 04:51:05,770 - backend.crewai_app.custom_tool - INFO - ✅ Successfully inspected: C:\Users\Anush\AppData\Local\Temp\tmpo1f7inhd.xlsx
2025-10-07 04:51:05,770 - backend.crewai_app.custom_tool - INFO - 📊 Inspection completed. Files inspected: 3
2025-10-07 04:51:05,791 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 04:51:06,466 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 04:51:11,793 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 04:51:13,229 - LiteLLM - INFO - Wrapper: Completed Call, calling success_handler
2025-10-07 04:51:13,301 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 04:51:17,119 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 04:51:55,795 - LiteLLM - INFO - Wrapper: Completed Call, calling success_handler
2025-10-07 04:51:55,869 - backend.main - INFO - Crew execution completed successfully
2025-10-07 04:51:55,871 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpsofhogtp.xlsx
2025-10-07 04:51:55,871 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpit0nccgi.xlsx
2025-10-07 04:51:55,872 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpo1f7inhd.xlsx
2025-10-07 04:51:57,409 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 04:51:57,629 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 17:43:56,921 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 17:45:27,502 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 17:46:47,589 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 17:47:27,420 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 17:47:29,650 - LiteLLM - INFO - Wrapper: Completed Call, calling success_handler
2025-10-07 17:47:29,661 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 17:47:30,345 - LiteLLM - INFO - Wrapper: Completed Call, calling success_handler
2025-10-07 17:47:45,681 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 17:47:53,670 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 17:49:51,645 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-07 17:49:51,647 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': None}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. You excel at parsing JSON inspection results from Excel files and creating precise data processing scripts.\n', 'output_format': 'python_code_only', 'instructions': ['First, use the Excel Data Inspector Tool to get JSON structure of all Excel files.', 'Parse the JSON response to understand column names, data types, and sample data.', 'Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments referencing the JSON inspection results.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.', 'Handle multiple Excel files by merging them when appropriate.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. You verify that the script correctly uses column names and data types from the JSON inspection.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Verify column names match those in the JSON inspection results.', 'Ensure data type conversions are appropriate for the actual data.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-07 17:49:51,647 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': 'CRITICAL: You MUST use the \'Excel Data Inspector Tool\' FIRST with these EXACT file paths: {files}\nThe tool will return JSON with inspection results. CHECK THE "success" FIELD: - If "success": false, STOP and return an error message explaining which files failed - If "success": true, proceed with script generation\nACTUAL File Paths: {files_str}\nUser Instructions: {prompt}\nStep 1: Call Excel Data Inspector Tool with: {files} Step 2: Parse JSON response - CHECK THE "success" FIELD Step 3: If inspection failed, return: "ERROR: File inspection failed - [list errors]" Step 4: If inspection succeeded, generate script using ACTUAL columns from JSON Step 5: NEVER use hypothetical file names or assume column structures\nIMPORTANT: If file inspection fails, return an error message, NOT Python code!\n', 'expected_output': 'Either: - A complete, executable Python script (if file inspection succeeded) - OR an error message starting with "ERROR:" (if file inspection failed)\n'}, 'validation_task': {'description': 'CRITICAL: Review the generated Python script against: 1. The actual file structure from JSON inspection of: {files_str} 2. User instructions: {prompt}\nVerify that: - The script correctly handles the column names and data types found in the JSON inspection - All requested transformations from the prompt are implemented - The script properly handles multiple files if provided - Proper error handling and data validation are included - The code is efficient and well-commented\nPay special attention to: - Column name matching (exact names from JSON inspection) - Data type conversions - File merging logic for multiple files - Reference file mappings if required\nIf corrections are needed, provide the complete corrected script.\n', 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.'}}
2025-10-07 17:49:51,653 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 17:49:51,654 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 17:49:51,654 - backend.crewai_app.crew - INFO - 🔑 Using API Key: AIzaSyBea7...
2025-10-07 17:49:51,654 - backend.crewai_app.crew - INFO - 🤖 Using Model: gemini/gemini-2.5-flash
2025-10-07 17:49:51,670 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 17:49:53,398 - LiteLLM - INFO - Wrapper: Completed Call, calling success_handler
2025-10-07 17:52:30,758 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 17:52:30,759 - python_multipart.multipart - DEBUG - Calling on_header_field with data[36:55]
2025-10-07 17:52:30,759 - python_multipart.multipart - DEBUG - Calling on_header_value with data[57:81]
2025-10-07 17:52:30,759 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 17:52:30,759 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 17:52:30,761 - python_multipart.multipart - DEBUG - Calling on_part_data with data[85:563]
2025-10-07 17:52:30,761 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 17:52:30,762 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 17:52:30,762 - python_multipart.multipart - DEBUG - Calling on_header_field with data[601:620]
2025-10-07 17:52:30,762 - python_multipart.multipart - DEBUG - Calling on_header_value with data[622:665]
2025-10-07 17:52:30,763 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 17:52:30,763 - python_multipart.multipart - DEBUG - Calling on_header_field with data[667:679]
2025-10-07 17:52:30,763 - python_multipart.multipart - DEBUG - Calling on_header_value with data[681:746]
2025-10-07 17:52:30,763 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 17:52:30,764 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 17:52:30,764 - python_multipart.multipart - DEBUG - Calling on_part_data with data[750:6210]
2025-10-07 17:52:30,767 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 17:52:30,769 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 17:52:30,769 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6248:6267]
2025-10-07 17:52:30,769 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6269:6312]
2025-10-07 17:52:30,773 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 17:52:30,774 - python_multipart.multipart - DEBUG - Calling on_header_field with data[6314:6326]
2025-10-07 17:52:30,776 - python_multipart.multipart - DEBUG - Calling on_header_value with data[6328:6393]
2025-10-07 17:52:30,777 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 17:52:30,777 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 17:52:30,778 - python_multipart.multipart - DEBUG - Calling on_part_data with data[6397:11862]
2025-10-07 17:52:30,779 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 17:52:30,779 - python_multipart.multipart - DEBUG - Calling on_part_begin with no data
2025-10-07 17:52:30,780 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11900:11919]
2025-10-07 17:52:30,782 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11921:11964]
2025-10-07 17:52:30,782 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 17:52:30,783 - python_multipart.multipart - DEBUG - Calling on_header_field with data[11966:11978]
2025-10-07 17:52:30,783 - python_multipart.multipart - DEBUG - Calling on_header_value with data[11980:12045]
2025-10-07 17:52:30,784 - python_multipart.multipart - DEBUG - Calling on_header_end with no data
2025-10-07 17:52:30,784 - python_multipart.multipart - DEBUG - Calling on_headers_finished with no data
2025-10-07 17:52:30,784 - python_multipart.multipart - DEBUG - Calling on_part_data with data[12049:17500]
2025-10-07 17:52:30,785 - python_multipart.multipart - DEBUG - Calling on_part_end with no data
2025-10-07 17:52:30,786 - python_multipart.multipart - DEBUG - Calling on_end with no data
2025-10-07 17:52:30,788 - backend.main - INFO - Processing 3 Excel files with prompt: 1. Merge all files that start with 'TCE_Callflow_Details_File_'.
2. Convert the 'DL_Volume_5QI1_towards_UE', 'UL_Volume_
2025-10-07 17:52:30,790 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpoe6fpy8h.xlsx (original: t3.xlsx)
2025-10-07 17:52:30,791 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpi7jtc0ue.xlsx (original: t2.xlsx)
2025-10-07 17:52:30,793 - backend.main - INFO - Saved temporary Excel file: C:\Users\Anush\AppData\Local\Temp\tmpyvyuxg26.xlsx (original: t1.xlsx)
2025-10-07 17:52:30,793 - backend.main - INFO - Starting crew execution...
2025-10-07 17:52:30,793 - backend.crewai_app.crewmain - INFO - 🔑 API Key before crew: LOADED
2025-10-07 17:52:30,795 - backend.crewai_app.crewmain - INFO - Launching CsvOrganiser crew with inputs:
2025-10-07 17:52:30,795 - backend.crewai_app.crewmain - INFO - files (list): ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpoe6fpy8h.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpi7jtc0ue.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpyvyuxg26.xlsx']
2025-10-07 17:52:30,803 - backend.crewai_app.crew - INFO - CsvOrganiser initialized with agents/tasks configs
2025-10-07 17:52:30,804 - backend.crewai_app.crew - DEBUG - Loaded agents config: {'default_llm': {'model': 'gemini/gemini-2.5-flash', 'api_key': None}, 'script_generator': {'role': 'Code Generator and Data Processing Expert\n', 'goal': 'Generate a complete, structured, and executable Python script to process Excel data exactly according to instructions.\n', 'backstory': 'You are a Python expert in data science, tasked with generating scripts that perform row and column transformations, data cleaning, merging, and feature engineering as specified by the user. You excel at parsing JSON inspection results from Excel files and creating precise data processing scripts.\n', 'output_format': 'python_code_only', 'instructions': ['First, use the Excel Data Inspector Tool to get JSON structure of all Excel files.', 'Parse the JSON response to understand column names, data types, and sample data.', 'Return ONLY a valid Python script — no explanations, no markdown, no extra text.', 'Organize code into clearly labeled steps with comments.', 'For each transformation, include checks for missing columns and data inconsistencies.', 'Document each operation with comments referencing the JSON inspection results.', 'Use pandas best practices and ensure numeric conversions and merges are handled gracefully.', 'Prepare the code to be easily adaptable by updating file paths and parameters.', 'Handle multiple Excel files by merging them when appropriate.'], 'allow_delegation': False}, 'validator': {'role': 'Code Validator and Quality Assurance Specialist\n', 'goal': 'Review the generated script and ensure it performs all transformations described without extra or missing operations. Provide specific, actionable feedback.\n', 'backstory': 'You are a meticulous QA engineer, comparing the script against instructions step by step. You verify that the script correctly uses column names and data types from the JSON inspection.\n', 'output_format': 'python_code_only', 'instructions': ['If the script is correct, output ONLY the final valid Python code.', 'If corrections are needed, output the corrected full script — no commentary.', 'Check that each transformation is implemented correctly and safely.', 'Verify column names match those in the JSON inspection results.', 'Ensure data type conversions are appropriate for the actual data.', 'Limit feedback to one revision max.'], 'allow_delegation': False}}
2025-10-07 17:52:30,804 - backend.crewai_app.crew - DEBUG - Loaded tasks config: {'script_generation_task': {'description': 'CRITICAL: You MUST use the \'Excel Data Inspector Tool\' FIRST with these EXACT file paths: {files}\nThe tool will return JSON with inspection results. CHECK THE "success" FIELD: - If "success": false, STOP and return an error message explaining which files failed - If "success": true, proceed with script generation\nACTUAL File Paths: {files_str}\nUser Instructions: {prompt}\nStep 1: Call Excel Data Inspector Tool with: {files} Step 2: Parse JSON response - CHECK THE "success" FIELD Step 3: If inspection failed, return: "ERROR: File inspection failed - [list errors]" Step 4: If inspection succeeded, generate script using ACTUAL columns from JSON Step 5: NEVER use hypothetical file names or assume column structures\nIMPORTANT: If file inspection fails, return an error message, NOT Python code!\n', 'expected_output': 'Either: - A complete, executable Python script (if file inspection succeeded) - OR an error message starting with "ERROR:" (if file inspection failed)\n'}, 'validation_task': {'description': 'CRITICAL: Review the generated Python script against: 1. The actual file structure from JSON inspection of: {files_str} 2. User instructions: {prompt}\nVerify that: - The script correctly handles the column names and data types found in the JSON inspection - All requested transformations from the prompt are implemented - The script properly handles multiple files if provided - Proper error handling and data validation are included - The code is efficient and well-commented\nPay special attention to: - Column name matching (exact names from JSON inspection) - Data type conversions - File merging logic for multiple files - Reference file mappings if required\nIf corrections are needed, provide the complete corrected script.\n', 'expected_output': 'The final, validated, and complete Python script — no explanations, no markdown, just valid Python code.'}}
2025-10-07 17:52:30,810 - backend.crewai_app.crew - INFO - 📝 Creating script_generation_task with JSON inspection requirement
2025-10-07 17:52:30,811 - backend.crewai_app.crew - INFO - 🔧 Creating script_generator agent with enhanced JSON inspection
2025-10-07 17:52:30,811 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 17:52:30,812 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 17:52:30,812 - backend.crewai_app.crew - INFO - 🔑 Using API Key: AIzaSyBea7...
2025-10-07 17:52:30,812 - backend.crewai_app.crew - INFO - 🤖 Using Model: gemini/gemini-2.5-flash
2025-10-07 17:52:30,815 - backend.crewai_app.crew - INFO - 📝 Creating validation_task with JSON-aware validation
2025-10-07 17:52:30,816 - backend.crewai_app.crew - INFO - 🔧 Creating validator agent with JSON-aware validation
2025-10-07 17:52:30,816 - backend.crewai_app.crew - INFO - 🔑 Env API Key: SET
2025-10-07 17:52:30,816 - backend.crewai_app.crew - INFO - 🔑 Final API Key: SET
2025-10-07 17:52:30,816 - backend.crewai_app.crew - INFO - 🔑 Using API Key: AIzaSyBea7...
2025-10-07 17:52:30,818 - backend.crewai_app.crew - INFO - 🤖 Using Model: gemini/gemini-2.5-flash
2025-10-07 17:52:30,920 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 17:52:32,635 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): telemetry.crewai.com:4319
2025-10-07 17:52:33,954 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 17:52:34,576 - LiteLLM - INFO - Wrapper: Completed Call, calling success_handler
2025-10-07 17:52:34,613 - backend.crewai_app.custom_tool - INFO - 🔍 Inspecting 3 files: ['C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpoe6fpy8h.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpi7jtc0ue.xlsx', 'C:\\Users\\Anush\\AppData\\Local\\Temp\\tmpyvyuxg26.xlsx']
2025-10-07 17:52:34,614 - backend.crewai_app.custom_tool - INFO - ✅ File found at original path: C:\Users\Anush\AppData\Local\Temp\tmpoe6fpy8h.xlsx
2025-10-07 17:52:34,614 - backend.crewai_app.custom_tool - INFO - 📖 Reading Excel file: C:\Users\Anush\AppData\Local\Temp\tmpoe6fpy8h.xlsx
2025-10-07 17:52:36,957 - backend.crewai_app.custom_tool - INFO - ✅ Successfully inspected: C:\Users\Anush\AppData\Local\Temp\tmpoe6fpy8h.xlsx
2025-10-07 17:52:36,957 - backend.crewai_app.custom_tool - INFO - ✅ File found at original path: C:\Users\Anush\AppData\Local\Temp\tmpi7jtc0ue.xlsx
2025-10-07 17:52:36,958 - backend.crewai_app.custom_tool - INFO - 📖 Reading Excel file: C:\Users\Anush\AppData\Local\Temp\tmpi7jtc0ue.xlsx
2025-10-07 17:52:36,982 - backend.crewai_app.custom_tool - INFO - ✅ Successfully inspected: C:\Users\Anush\AppData\Local\Temp\tmpi7jtc0ue.xlsx
2025-10-07 17:52:36,982 - backend.crewai_app.custom_tool - INFO - ✅ File found at original path: C:\Users\Anush\AppData\Local\Temp\tmpyvyuxg26.xlsx
2025-10-07 17:52:36,983 - backend.crewai_app.custom_tool - INFO - 📖 Reading Excel file: C:\Users\Anush\AppData\Local\Temp\tmpyvyuxg26.xlsx
2025-10-07 17:52:37,020 - backend.crewai_app.custom_tool - INFO - ✅ Successfully inspected: C:\Users\Anush\AppData\Local\Temp\tmpyvyuxg26.xlsx
2025-10-07 17:52:37,020 - backend.crewai_app.custom_tool - INFO - 📊 Inspection completed. Success: True, Files inspected: 3
2025-10-07 17:52:37,061 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 17:52:39,201 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 17:52:47,984 - LiteLLM - INFO - Wrapper: Completed Call, calling success_handler
2025-10-07 17:52:48,044 - LiteLLM - INFO - 
LiteLLM completion() model= gemini-2.5-flash; provider = gemini
2025-10-07 17:52:49,519 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 17:53:20,038 - LiteLLM - INFO - Wrapper: Completed Call, calling success_handler
2025-10-07 17:53:20,088 - backend.main - INFO - Crew execution completed successfully
2025-10-07 17:53:20,089 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpoe6fpy8h.xlsx
2025-10-07 17:53:20,090 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpi7jtc0ue.xlsx
2025-10-07 17:53:20,091 - backend.main - INFO - Removed temporary file: C:\Users\Anush\AppData\Local\Temp\tmpyvyuxg26.xlsx
2025-10-07 17:53:24,845 - urllib3.connectionpool - DEBUG - https://telemetry.crewai.com:4319 "POST /v1/traces HTTP/1.1" 200 2
2025-10-07 17:53:25,044 - asyncio - DEBUG - Using selector: SelectSelector
2025-10-07 22:33:06,612 - asyncio - DEBUG - Using selector: SelectSelector
